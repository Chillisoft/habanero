<html>

<head>
<meta http-equiv="Content-Language" content="en-za">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>HABANERO TUTORIAL</title>

<style type="text/css">
table.code {
  background-color: #EEEEEE;
  border-collapse: collapse;
  border-spacing: 0px;
  border-color: #EEEEEE;
  border: 1px;
}

td.codeclass {
  background-color: #EFEACB;
  padding:5px;
  font-size: 10px;
} 

td.codeitself {
  background-color: #F9F9F0;
  padding:2;
}

td.specclass {
  background-color: #F9F9F9;
  font-size:10pt;
  vertical-align: top;
}

a.specclasslink {
	text-decoration:none;
	color:black;
}

a.specclasslink:hover {
	text-decoration:none;
	color:black;
}

table.spec {
  font-size:10pt;
}

td.specname {
  border-right:1px solid silver; border-bottom:1px solid silver; border-left-color:silver; border-top-color:silver;
  vertical-align: top;
  width:120px;
  font-size:8pt;
}

td.specvalue {
  border-bottom:1px solid silver; border-left:1px solid silver; border-right-color:silver; border-top-color:silver;
  vertical-align: top;
  font-size:8pt;
}

td.specnamebottom {
  border-right:1px solid silver; border-bottom:0px solid silver; border-left-color:silver; border-top-color:silver;
  vertical-align: top;
  font-size:8pt;
}

td.specvaluebottom {
  border-bottom:0px solid silver; border-left:1px solid silver; border-right-color:silver; border-top-color:silver;
  vertical-align: top;
  font-size:8pt;
}

table.options {
}

td.options {
  font-size:8pt;
  vertical-align: top;
}

body, p {
  color:black;
  font-family: verdana, arial, helvetica, sans-serif;
  font-size:12px;
}
</style>
    
</head>

<body>

<p><font face="Verdana" size="5" color="#000080"><b>HABANERO TUTORIAL</b></font></p>
<p><font size="2" color="#808080">For Habanero Beta v1.0, July 2007<br>
More information can be found at: </font>
<a href="http://www.chillisoft.co.za/habanero">
www.chillisoft.co.za/habanero</a><br>
<font size="2" color="#808080">Any feedback on this tutorial would be 
invaluable: <a href="mailto:habanero@chillisoft.co.za">habanero@chillisoft.co.za</a> 
or <a href="http://www.chillisoft.co.za/habanero/support">
www.chillisoft.co.za/habanero/support</a> </font></p>
<p>&nbsp;</p>
<p><font size="2">This tutorial provides a hands-on guide to using the Habanero 
architecture to create applications that interact with databases.&nbsp; The 
tutorial steps through a demo application in C#, first dealing with installation and 
setup and moving along to more advanced usage.&nbsp; Depending on your style of 
learning, you may want to build the demo application yourself as you read each 
section.</font></p>
<table border="1" cellpadding="10" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber2" bgcolor="#F2F2F2">
  <tr>
    <td width="100%" bgcolor="#E4E4E4"><b>Contents:</b></td>
  </tr>
  <tr>
    <td width="100%">
    <ul>
      <li><a href="#OurStory">Our Story</a><br>
      <font size="2">Introduces a simple storyline used to build the demo 
      application</font><br>
&nbsp;</li>
      <li><a href="#HabaneroThink">Understanding Habanero-think</a><br>
<font size="2">Some background understanding of the architecture along with 
      standard concepts<br>
&nbsp;</font></li>
      <li><a href="#Step1">Step 1: Installing Habanero</a><br>
      <font size="2">Covers system requirements and installation procedures and 
      challenges<br>
&nbsp;</font></li>
      <li><a href="#Step2">Step 2: Setting up a simple application</a><br>
<font size="2">Setting up a simple application with a user interface that 
      displays business objects</font><br>
&nbsp;</li>
      <li><a href="#Step3">Step 3: Creating relationships</a><br>
      <font size="2">Covers some user interface enhancements, relationships between 
      objects and editing an object's properties</font><br>
&nbsp;</li>
      <li><a href="#Step4">Step 4: User interface enhancements</a><br>
      <font size="2">Adds more features to the user interface<br>
&nbsp;</font></li>
      <li><a href="#Step5">Step 5: Introducing inheritance</a><br>
      <font size="2">Have supplier orders inherit parts order functionality<br>
&nbsp;</font></li>
      <li><a href="#AppendixI">Appendix I - Class definitions</a><br>
      <font face="Verdana,Arial,Helvetica" size="2">Covers a list of 
      explanations, possible options and limitations for class definitions<br>
&nbsp;</font></li>
      <li><a href="#AppendixII">Appendix II - Using Log4net</a><br>
      <font size="2">Lists specific settings for logging system or error 
      messages<br>
&nbsp;</font></li>
      <li><a href="#Troubleshooting">Troubleshooting</a></li>
    </ul>
    </td>
  </tr>
</table>
<p>&nbsp;</p>
<hr>
<table border="1" cellpadding="6" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber1" bgcolor="#F2F2F2">
  <tr>
    <td width="100%" bgcolor="#2F2F84"><b>
    <font face="Verdana" color="#FFFFFF" size="4"><a name="OurStory">Our Story</a></font></b></td>
  </tr>
</table>
<p><font face="Verdana" size="2">
<img border="0" src="replaceit-logo.gif" width="151" height="46">Our computer 
parts supply business, Replace-IT, has grown beyond all expectations and the 
orders are raining down from all over the country.&nbsp; With so much stock 
moving in and out of the door these days, it wasn't going to be long before our 
makeshift stock control system would begin to crack up.&nbsp; The poor 
receptionist is spending hours each day logging calls from irate customers whose 
orders have either been wrongly fulfilled or have simply slipped through the 
cracks.</font></p>
<p><font face="Verdana" size="2">It's time for a customised system, and being an 
IT firm, we feel we have enough know-how to code our own system.&nbsp; So off we 
go, load up the coffee machine, crank up some rock music and pull out the SQL 
manual for the first time.</font></p>
<p><font face="Verdana" size="2">We've decided to code the system in C# with 
object orientation, using the MySQL database to store the parts and sales data.&nbsp; 
After getting &quot;Hello, world&quot; working and taking fifteen minutes to celebrate, it's heads-down for the real grind.</font></p>
<p><font face="Verdana" size="2">And it all grinds to a halt.&nbsp; Having drawn 
up a plan of our object structure, we then sit down and map out the database 
table structure.&nbsp; It suddenly dawns on us: how do you reconcile the two?&nbsp; 
Surely there must be a simple way?&nbsp; With a splatter of keyboard strokes and 
a tick-tick of mouse buttons, our browser calls up the Habanero architecture to solve all 
the world's problems ... well, except for plate tectonics.</font></p>
<p><b><font face="Verdana" size="3">The Problem</font></b></p>
<p><font face="Verdana" size="2">The microwave culture is hitting programming 
and why not?&nbsp; The hunt is on to find an easier, quicker, cleaner and more 
error-free way to achieve a programming task.&nbsp; Despite continued 
innovation, there are still some glaring efficiency gaps, including SQL's jagged 
interface with object-oriented programming.</font></p>
<p><font face="Verdana" size="2">Habanero was developed by a group of software 
developers that ran into the continuous problem of having to provide the 
intermediate between object-oriented code and database tables.&nbsp; A pattern of usage developed and Habanero was packaged 
together with recurring functionality from the different applications.&nbsp; Furthermore, the architecture 
remained in use by the team for a long period before being released onto the 
market, considerably improving stability and ensuring that the software is 
relevant to real-world business needs.</font></p>
<p><font face="Verdana" size="2">What sets Habanero apart from other flavours of 
persistence or object-relational mapping (ORM) solutions is the ability to 
generate user interfaces that are automatically mapped to the object as well.&nbsp; 
The implication is that you can build a functional database-dependent 
application with visual results in very little time.&nbsp; Imagine writing a 
prototype application right in your client's office, in a matter of minutes 
literally.</font></p>
<p><b><font face="Verdana" size="3">Revisiting the Business</font></b></p>
<p><font face="Verdana" size="2">Having decided on using Habanero, it's time to 
get this vehicle out of the garage and onto the road.&nbsp; Our objective is to 
set up our system incrementally, getting the basic structure up and running 
first and then adding the bells and whistles as we go.</font></p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<hr>
<table border="1" cellpadding="6" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber12" bgcolor="#F2F2F2">
  <tr>
    <td width="100%" bgcolor="#2F2F84"><b>
    <font face="Verdana" color="#FFFFFF" size="4"><a name="HabaneroThink">
    Understanding Habanero-think</a></font></b></td>
  </tr>
  <tr>
    <td width="100%">
<p><font face="Verdana" size="2">This section paints a picture of Habanero's 
view of the world:</font></p>
<ul>
  <li><font face="Verdana" size="2">What does Habanero try to fix?</font></li>
  <li><font face="Verdana" size="2">How does Habanero carry out mapping?</font></li>
  <li><font face="Verdana" size="2">What are business objects?</font></li>
  <li><font face="Verdana" size="2">What about Sql?</font></li>
</ul>
    </td>
  </tr>
</table>
<p>The following information may be useful to you if you like to get a basic 
theoretical understanding of a framework.&nbsp; Alternatively, if you prefer a 
hands-on approach, you can skip this section and come back to it later.</p>
<p><b><font size="3">What Does Habanero Try to Fix?</font></b></p>
<p>Habanero attempts to tackle two primary problems.</p>
<p>Firstly, there are a number of repetitive steps required to copy values from 
relational databases, which are not object-oriented, to objects in code.&nbsp; 
Database connections need to be coded and managed, and the particular quirks of 
each database vendor need to be understood.&nbsp; Then Sql statements must be 
written for each type of action (create, read, update, delete) and for each 
property of each object.&nbsp; Concurrency checks need to be done, and some kind 
of mapping for inheritance and relationships must also be managed.&nbsp; In 
short, there's a vast amount of work covered in these actions, and what's more 
frustrating is that they are largely repetitive from project to project.&nbsp; 
Equally, making small changes to a database structure can result in a large 
amount of readjustment in the code as well.</p>
<p>Habanero tackles a large amount of this work, carrying out object relational 
mapping (ORM) according to specifications you provide.</p>
<p>Secondly, there is considerable repetition in designing a user interface and 
mapping each control to a property, as well as ensuring that each property 
provides up-to-date values that reflect the database content.</p>
<p>Of course, individual requirements for user interfaces can vary vastly, and 
it is unlikely that any one solution can automate most developers' requirements.&nbsp; 
However, Habanero does provide a large array of functionality to create full 
user interfaces or components of a user interface, and then map these to 
properties as the developer specifies.&nbsp; These properties are then kept 
up-to-date by the background engine as you use the components at run-time.&nbsp; 
Depending on your application, this can present a considerable time-saving.</p>
<p><b><font size="3">How Does Habanero Carry Out Mapping?</font></b></p>
<p>As a developer, you will need to carry out three steps to mapping code to 
databases with Habanero.&nbsp; These steps can be carried out in any order.&nbsp; 
First, design the database.&nbsp; Second, create the classes.&nbsp; Third, 
create the XML class definitions that define how to map the properties.</p>
<p>With regards to creating the classes, all classes are required to inherit 
from Habanero's BusinessObject and implement a constructor. For each property value that must be mapped, the 
property will need <i>get</i> and <i>set</i> methods that use a Habanero-provided method to 
carry out the persistence.</p>
<p>The class definitions are contained in a single XML file that you can manage 
using Habanero's FireStarter application.&nbsp; This file lists:</p>
<ul>
  <li>Each class that needs to be mapped</li>
  <li>The properties in each class to map to</li>
  <li>The primary key</li>
  <li>Property rules, types and limitations</li>
  <li>Relationships between tables</li>
  <li>How user interfaces can display the class data</li>
</ul>
<p>A minimal application then requires about 10 lines of code and 10 lines of 
database configuration settings to compile and launch.</p>
<p><b><font size="3">What are Business Objects?</font></b></p>
<p>Business objects are entities that in some way represent different components 
that make up business logic.&nbsp; For instance, in the manufacture of a car, 
the wheels, door, bonnet, seat and ignition all make up business objects.&nbsp; 
An email client provides more a more abstract example: an individual email, an 
address book, a blocked-senders list and a preference settings list could all be 
business objects.&nbsp; Essentially business objects are well used term in the 
IT industry to differentiate these kinds of components from other objects like 
widgets in a user interface or components of your database connection 
architecture.</p>
<p>Habanero's BusinessObject provides a range of common functionality to its 
inheritors.&nbsp; Most importantly it hands down the tools to carry out 
persistence of the properties to and from the database.</p>
<p><b><font size="3">What About Sql?</font></b></p>
<p>There is some debate at the moment on the wisdom of either hiding developers 
from the power of Sql or giving the developers open room to create errors 
through faulty Sql code.&nbsp; In Habanero, both sides are catered for to some 
extent.</p>
<p>At a simple level, you will hardly write any Sql while using Habanero.&nbsp; 
Basic persistence to and from the database is handled by Habanero, which 
automatically constructs the Sql needed for each property value and adapts each 
statement to cater for the database vendor you specified (assuming support is 
available for that vendor).</p>
<p>There are, however, times when you will need to use some level of Sql.&nbsp; 
At a simple level, you can place restraints on how many objects are loaded in a 
collection of business objects, and how these are ordered.&nbsp; These are 
provided using Sql criteria that will be appended to the Sql statements.&nbsp; 
Secondly, Habanero provides support for migrations, so that you can take an 
updated application to an outdated client installation, and the application will 
automatically update the client using the Sql statements you have provided.&nbsp; 
Finally, you can still carry out a self-created Sql statement at any place in 
your code.&nbsp; You can construct the statement with a single string, or you 
can safely build a SqlStatement object out of components.</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<hr>
<table border="1" cellpadding="6" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber1" bgcolor="#F2F2F2">
  <tr>
    <td width="100%" bgcolor="#2F2F84"><b>
    <font face="Verdana" color="#FFFFFF" size="4"><a name="Step1">Step 1: Installing Habanero</a></font></b></td>
  </tr>
  <tr>
    <td width="100%">

<p><font face="Verdana" size="2">In this section we discuss the procedures for 
acquiring and installing Habanero:</font></p>

<ul>
  <li><font face="Verdana" size="2">System requirements</font></li>
  <li><font face="Verdana" size="2">Licensing</font></li>
  <li><font face="Verdana" size="2">Download and installation</font></li>
  <li><font face="Verdana" size="2">Technical help/support</font></li>
</ul>
    </td>
  </tr>
</table>
<p><b><font size="3">System Requirements</font></b></p>

<p>Habanero is a .Net product, so you will need to install the .Net 2.0 (or 
above) framework.&nbsp; You will also need to meet the .Net 2.0 minimum 
requirements.&nbsp; As far as application requirements go, this depends heavily 
on the type of application you will be developing.&nbsp; For client 
installations, you require Windows 2000 or above and will typically need a 
Pentium 4 1.6ghz, 256mb RAM for Windows 2000 or 512mb RAM for Windows XP.&nbsp; 
The minimum requirements for Windows Vista applications are not yet clear.</p>

<p><b><font size="3">Licensing</font></b></p>

<p>At the time of this tutorial, Habanero is being released on a beta basis.&nbsp; 
The beta was released on July 1, 2007 and the free, 3-month license will expire 
on October 1, 2007.&nbsp; During this period, we would love to have feedback on 
the product, its usefulness and its drawbacks.&nbsp; See the links at the top of 
this document for avenues to give us some feedback.</p>

<p><b><font size="3">Download and Installation</font></b></p>

<p>You can download Habanero Beta from the Habanero website:
<a href="http://www.chillisoft.co.za/habanero/download">
www.chillisoft.co.za/habanero/download</a></p>

<p><font color="#FF0000">&lt;&lt;instructions for unzipping/installation/licensing&gt;&gt;, 
log4net.dll, .net, other dll's, installing databases</font></p>

<p>Once you have chosen the database vendor you will be using, follow the 
installation instructions for that database.&nbsp; Your Habanero-based 
application will need access to the DLL's that come with that installation.</p>

<p><b><font size="3">Technical Support</font></b></p>

<p>Chillisoft provides support for Habanero through the website:
<a href="http://www.chillisoft.co.za/habanero/support">
www.chillisoft.co.za/habanero/support</a>.&nbsp; You can request support, 
provide feedback or report bugs.&nbsp; Any bug reports are incredibly valuable 
to our development team.</p>

<p>&nbsp;</p>

<p>&nbsp;</p>
<hr>
<table border="1" cellpadding="6" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber1" bgcolor="#F2F2F2">
  <tr>
    <td width="100%" bgcolor="#2F2F84"><b>
    <font face="Verdana" color="#FFFFFF" size="4"><a name="Step2">Step 2: Setting up a simple 
    application</a></font></b></td>
  </tr>
  <tr>
    <td width="100%">
<font size="2">We will set up a simple 
application with a user interface that displays business objects:</font><ul>
  <li><font face="Verdana" size="2">Designing the database</font></li>
  <li><font face="Verdana" size="2">Setting up the project/solution</font></li>
  <li><font face="Verdana" size="2">Configuring database settings</font></li>
  <li><font face="Verdana" size="2">Weaving in Habanero</font></li>
  <li><font face="Verdana" size="2">Writing the class definitions</font></li>
  <li><font face="Verdana" size="2">Running the application</font></li>
</ul>
    </td>
  </tr>
</table>
<p><font size="3"><b>Designing the Database</b></font></p>
<p><font size="2">Before we begin on the code side, let's set up the database 
tables.&nbsp; At this stage you'll have to have chosen your database of choice 
and installed it. For this 
tutorial we'll be using the MySQL database.&nbsp; We open the database 
administrator and create a new schema called &quot;replace_it&quot;.&nbsp; It's time for 
our first table, which will hold our computer parts.&nbsp; We'll call it 
ComputerPart - no surprises there.&nbsp; We'll start with three columns.&nbsp; 
The first is &quot;ID&quot; which serves as the primary key.&nbsp; Now there is 
some 
debate on primary keys and what format they take, but for our example, our 
primary key will be a Guid and will remain discrete.&nbsp; In MySQL, a Guid can 
be represented as a CHAR(38) type.&nbsp; Our other two fields will be 
Description as VARCHAR(500) and the Price as DECIMAL(10,2).&nbsp; Here is an 
image of our structure as in the MySQL administrator: </font></p>
<p align="center">
<img border="0" src="database-part_setup.gif" width="651" height="83"></p>
<p><b><font size="3">Setting up the Project/Solution</font></b></p>
<p><font size="2">Fire up your standard IDE or text editor and set up a new 
project.&nbsp; If you're using Visual Studio, for instance, add a new project 
called &quot;Replace_it&quot; as a Windows Application (in this example).&nbsp; You might 
also want to add a &quot;lib&quot; folder under &quot;Replace_it&quot;, to store the dll's needed by 
the project, and a &quot;docs&quot; folder for any notes you want to take or documentation 
you want to write.</font></p>
<p><font size="2">First up we'll need to reference some DLL's that are important 
to our application.&nbsp; Add references to the Habanero DLL's you installed as 
instructed in Step 1.&nbsp; 
You may also need the following DLL's:</font></p>
<ul>
  <li><font size="2"><font color="#808080">log4net.dll</font> - This is the logging system that 
  Habanero supports for outputting runtime information to a specified log.&nbsp; 
  See Appendix II for more information.</font></li>
  <li><font size="2"><font color="#808080">MySql.Data.dll</font> - Used to manage MySql database 
  connections (if you're using a different database, you'll need to make 
  appropriate adjustments here)</font></li>
  <li><font size="2"><font color="#808080">Noogen.Winforms.dll</font> - Used to 
  generate combo-boxes</font></li>
</ul>
<p><font size="2">These will all need to be referenced from within your IDE as 
well (right click on the References folder and &quot;Add reference&quot;).</font></p>
<p><font size="2">Now if, for instance, you've created a new project in Visual 
Studio 2005, you'll see that two classes have been added already: &quot;Form1.cs&quot; and 
&quot;Program.cs&quot;.&nbsp; If you're using a different IDE, go ahead and create these 
two for consistency (or their equivalents). The initial C# code provided for us is as follows:</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" height="20" class="codeclass" >
    <b><font size="2">Program.cs</font></b><font size="2"> </font>
    </td>
  </tr>
  <tr>
    <td class="codeitself" >
    <pre><code>using System;
using System.Windows.Forms;

namespace Replace_it
{
    static class Program
    {
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
        }
    }
}</code></pre>
    </td>
  </tr>
</table>
<p>&nbsp;</p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td class="codeclass">
    <font size="2"><b>Form1.cs<br>
</b>Note: InitializeComponent() is implemented in an IDE-created class called Form1.Designer.cs</font>
    </td>
  </tr>
  <tr>
    <td class="codeitself"><pre><code>using System.Windows.Forms;

namespace Replace_it
{
	public partial class Form1 : Form
	{
		public Form1()
		{
			InitializeComponent();
		}
	}
}</code></pre>
    </td>
  </tr>
</table>
<p><b><font size="3">Configuring Database Settings</font></b></p>
<p><font size="2">The application needs to know how to connect to the database 
and this is done using the &quot;app.config&quot; file in Visual Studio (right-click on the project, 
&quot;add new item&quot; and choose &quot;Application 
Configuration File&quot;).&nbsp; Once the file has been added to the project, it 
should be amended to look something like that below.&nbsp; The options for 
vendor are &quot;mysql&quot;, &quot;access&quot;, &quot;sqlserver&quot; and &quot;oracle&quot;.&nbsp; Additionally, you 
may want to add logging support to your application, which is a simple operation 
- see Appendix II on how to add Log4net to the 
configuration file.</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeclass"><b><font size="2">app.config</font></b></td>
  </tr>
  <tr>
    <td width="100%" class="codeitself"><pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;configuration&gt;

  &lt;configSections&gt;
    &nbsp; &lt;section name=&quot;DatabaseConfig&quot; type=&quot;System.Configuration.DictionarySectionHandler&quot;/&gt;
  &lt;/configSections&gt;

  &lt;DatabaseConfig&gt;
    &lt;add key=&quot;vendor&quot; value=&quot;Mysql&quot;/&gt;
    &lt;add key=&quot;server&quot; value=&quot;localhost&quot;/&gt;
    &lt;add key=&quot;database&quot; value=&quot;replace_it&quot;/&gt;
    &lt;add key=&quot;username&quot; value=&quot;...&quot;/&gt;
    &lt;add key=&quot;password&quot; value=&quot;...&quot;/&gt;
    &lt;add key=&quot;port&quot; value=&quot;3306&quot;/&gt;
  &lt;/DatabaseConfig&gt;
&lt;/configuration&gt;</code></pre></td>
  </tr>
</table>
<p><b><font size="3">Weaving in Habanero</font></b></p>
<p><font size="2">We're going to begin by building a simple application that 
displays computer parts in a grid and allows us to add to and edit the list.</font></p>
<p><font size="2">We'll first set up a new class for ComputerPart that will map 
to its database table. As 
with all such objects, ComputerPart inherits from BusinessObject.&nbsp; 
Here is the code for a simple version of the class that provides properties to 
manipulate the class's fields.&nbsp; Note that if you're wanting to vary this 
for your own use, you'll only need to change the class name where appropriate 
and add or remove the properties for each of the fields you want to display or 
amend in your database table.</font></p>
<p><font size="2">Just a small but important note here on properties.&nbsp; When 
you edit the business objects through the standard user interfaces, the changes 
will be persisted to the database.&nbsp; However, when you amend a property 
directly in the code, you will then need to call Save() on the object to 
have the changes persisted.&nbsp; Thus, you can make several changes of 
calculations and only save the changes when you are ready.</font></p>
<p><font size="2">We also encourage the use of nullably types (with the ? on the 
end) - should you need to cast a nullable type to a non-nullable type, use 
&quot;.Value&quot;.</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" height="20" class="codeclass">
    <b><font size="2">ComputerPart.cs</font></b>
    </td>
  </tr>
  <tr>
    <td width="100%" height="291" class="codeitself">
    <pre><code>using System;
using Habanero.Bo;

namespace Replace_it
{

public class ComputerPart : BusinessObject
{
    public Guid? ComputerPartID
    {
        get { return (Guid?)GetPropertyValue(&quot;ComputerPartID&quot;); }
        set { SetPropertyValue(&quot;ComputerPartID&quot;, value); }
    }

    public string Description 
    {
        get { return (string)GetPropertyValue(&quot;Description&quot;); }
        set { SetPropertyValue(&quot;Description&quot;, value); }
    }

    public decimal? Price
    {
        get { return (decimal?)GetPropertyValue(&quot;Price&quot;); }
        set { SetPropertyValue(&quot;Price&quot;, value); }
    }
}
}</code></pre>
    </td>
  </tr>
</table>
<p><font size="2">Now we'll amend Program.cs to set up a standard application 
using HabaneroApp, which automatically initialises a number of key settings.&nbsp; 
We'll also add some optional code to make the error messaging a little neater.&nbsp; We'll need to include the appropriate packages:</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself"><pre><code>using Habanero.Ui.Base;
using Habanero.Base;</code></pre></td>
  </tr>
</table>
<p><font size="2">And in the Main() method we'll adapt the code to look like the 
following.&nbsp; HabaneroApp sets up the environment with a set of default 
options.&nbsp; You can customise those options before calling Startup() if you 
wish.&nbsp; You can also leave out the try/catch block if you want.</font></p>
<table class="code" border="1" cellspacing="0" width="526">
  <tr>
    <td width="520" class="codeitself"><pre><code>HabaneroApp mainApp = new HabaneroApp(&quot;Replace_IT&quot;, &quot;v1.0&quot;);
if (!mainApp.Startup()) return;

try
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.Run(new Form1());
}
catch (Exception ex)
{
    GlobalRegistry.UIExceptionNotifier.Notify(ex,
    &quot;An error has occurred in the application.&quot;,
    &quot;Application Error&quot;);
}</code></pre></td>
  </tr>
</table>
<p><font size="2">Moving along to Form1.cs, we'll add code to load the computer 
parts from the database into a collection of business objects and make them 
available to be read by the grid.&nbsp; When we load objects in the BO 
collection we have to specify search criteria and an order-by clause, which in 
this case we won't use (when we have large numbers of computer parts, we'll 
obviously want to limit the number loaded at any one time). We'll also 
instantiate the grid and add it to the provided form.&nbsp; Note that we use the 
BorderLayoutManager supplied with Habanero - this was created to cover for user 
interface shortfalls in .net.&nbsp; First the necessary inclusions:</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself"><pre><code>using Habanero.Bo;
using Habanero.Ui.Base;
using Habanero.Ui.Grid;</code></pre></td>
  </tr>
</table>
<p><font size="2">And now for the code, to be inserted just before 
InitializeComponents();...</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself"><pre><code>BusinessObjectCollection&lt;ComputerPart&gt; computerParts = new 
    BusinessObjectCollection&lt;ComputerPart&gt;();
computerParts.Load(&quot;&quot;, &quot;&quot;);

BorderLayoutManager manager = new BorderLayoutManager(this);
ReadOnlyGridWithButtons grid = new ReadOnlyGridWithButtons();
grid.SetCollection(computerParts);
manager.AddControl(grid, BorderLayoutManager.Position.Centre);</code></pre>
</td>
  </tr>
</table>
<p><b><font size="3">Writing the Class Definitions</font></b></p>
<p><font size="2">We have one last step now before our vehicle can hit the 
highway, and that is to provide the class definitions for our data.&nbsp; We're 
basically specifying how the database data is mapped to the classes, as well as what 
information we'd like to display in the grid.&nbsp; We add a new ClassDefs.xml 
file to the project (in Visual Studio you will also need to set the properties 
for the xml file so that it copies to the &quot;debug&quot; or output folder).&nbsp; You 
can find more information on class definitions in Appendix I.&nbsp; Note that the Habanero application will not run if no class definitions 
have been specified.</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself"><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;classes&gt;
  &lt;class name=&quot;ComputerPart&quot; assembly=&quot;Replace_it&quot;&gt;
    &lt;property name=&quot;ComputerPartID&quot; type=&quot;Guid&quot; /&gt;
    &lt;property name=&quot;Description&quot; /&gt;
    &lt;property name=&quot;Price&quot; type=&quot;Decimal&quot; /&gt;
    &lt;primaryKey&gt;
      &lt;prop name=&quot;ComputerPartID&quot; /&gt;
    &lt;/primaryKey&gt;
    &lt;ui&gt;
      &lt;grid&gt;
        &lt;column heading=&quot;Description&quot; property=&quot;Description&quot; /&gt;
        &lt;column heading=&quot;Price&quot; property=&quot;Price&quot; /&gt;
      &lt;/grid&gt;
      &lt;form height=&quot;150&quot; width=&quot;300&quot; title=&quot;Add a computer part&quot;&gt;
        &lt;field label=&quot;Description:&quot; property=&quot;Description&quot; /&gt;
        &lt;field label=&quot;Price:&quot; property=&quot;Price&quot; /&gt;
      &lt;/form&gt;
    &lt;/ui&gt;
  &lt;/class&gt;
&lt;/classes&gt;</code></pre></td>
  </tr>
</table>
<p><b><font size="3">Running the Application</font></b></p>
<p><font size="2">Everything is in place now and if we build and run the 
project, a window like this will pop up:</font></p>
<p align="center">
<img border="0" src="app-atfirst.gif" width="300" height="299"></p>
<p><font size="2">You should be able to click on the &quot;Add&quot; button and the newly 
added object should appear in the grid immediately.&nbsp; If that doesn't happen 
then you will need to check your database setup, the app.config file, the class 
definitions or the ComputerPart.cs class.&nbsp; Check, for instance, that 
you've provided the correct field names.</font></p>
<p><font size="2">Note that in this application we haven't included the 
ComputerPartID in the grid.&nbsp; This was partly a matter of choice and partly 
of principle.&nbsp; Regarding choice, a Guid is not as useful as a description 
when listing parts.&nbsp; Regarding principle, it's commonly held opinion that 
you shouldn't be changing your primary key, so we've designed the database to 
eliminate that possibility, keeping the primary key discrete.&nbsp; Of course, 
we will later add a unique reference number for each computer part, but that 
will be in a custom format rather than as a Guid, which is admittedly difficult 
to read and communicate.</font></p>
<p><b><font size="3">Further Exercises</font></b></p>
<p><font size="2">If you are looking to experiment, you could:</font></p>
<ul>
  <li><font size="2">Change the the computer part editing form so that the 
  description and price are edited in different tabs or different columns.</font></li>
  <li><font size="2">Check if the collection is empty at the start and display a 
  message box to the user instructing them on how to add computer parts.</font></li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr>
<table border="1" cellpadding="6" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber1" bgcolor="#F2F2F2">
  <tr>
    <td width="100%" bgcolor="#2F2F84"><b>
    <font face="Verdana" color="#FFFFFF" size="4"><a name="Step3">Step 3: 
    Creating Relationships</a></font></b></td>
  </tr>
  <tr>
    <td width="100%"><font size="2">This section covers user interface 
    enhancements, relationships between objects, and editing an object's 
    properties.&nbsp; We will extend our application to manage our stock levels 
    and customer orders, covering: </font><ul>
  <li><font face="Verdana" size="2">Adding ComputerPart fields</font></li>
  <li><font face="Verdana" size="2">Including customer orders</font></li>
  <li><font face="Verdana" size="2">Introducing multiple relationships</font></li>
</ul>
    </td>
  </tr>
</table>
<p><font face="Verdana" size="2">We can now successfully display our computer 
parts and we're not far away from having enough functions to track our business.&nbsp; 
At this stage we'll be looking to build some handling of customer orders into 
our system.</font></p>
<p><b><font face="Verdana" size="3">Adding ComputerPart Fields</font></b></p>
<p><font face="Verdana" size="2">Adding data fields for our parts will be a 
3-step process: amend the database, amend the class definitions and amend the 
class in the project.&nbsp; After adding some more important fields, our 
database structure now looks like this:</font></p>
<p align="center">
<img border="0" src="database-part_update.gif" width="650" height="138"></p>
<p><font face="Verdana" size="2">This class definitions have also been amended 
as below - at this stage we're beginning to filter just how much information we 
want to show at any one time.&nbsp; As far as data types for properties go, 
&quot;String&quot; is the default and the other types can be named either by their wrapper 
class names (eg. Int32) or their standard use names (eg. int).&nbsp; (see 
Appendix I for  a  list of data types in the class definitions).</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself">
    <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;classes&gt;

&lt;class name=&quot;ComputerPart&quot; assembly=&quot;Replace_it&quot;&gt;
  &lt;property name=&quot;ComputerPartID&quot; type=&quot;Guid&quot; /&gt;
  &lt;property name=&quot;Description&quot; /&gt;
  &lt;property name=&quot;Cost&quot; type=&quot;Decimal&quot; /&gt;
  &lt;property name=&quot;Price&quot; type=&quot;Decimal&quot; /&gt;
  &lt;property name=&quot;Stock&quot; type=&quot;Int32&quot; /&gt;
  &lt;property name=&quot;PartCode&quot; /&gt;
  &lt;primaryKey&gt;
    &lt;prop name=&quot;ComputerPartID&quot; /&gt;
  &lt;/primaryKey&gt;
  &lt;ui&gt;
    &lt;grid&gt;
      &lt;column heading=&quot;Part Code&quot; property=&quot;PartCode&quot; /&gt;
      &lt;column heading=&quot;Description&quot; property=&quot;Description&quot; /&gt;
      &lt;column heading=&quot;Cost&quot; property=&quot;Cost&quot; /&gt;
      &lt;column heading=&quot;Price&quot; property=&quot;Price&quot; /&gt;
      &lt;column heading=&quot;Stock&quot; property=&quot;Stock&quot; /&gt;
    &lt;/grid&gt;
    &lt;form height=&quot;250&quot; width=&quot;300&quot; title=&quot;Add a computer part&quot;&gt;
      &lt;field label=&quot;Part Code:&quot; property=&quot;PartCode&quot; /&gt;
      &lt;field label=&quot;Description:&quot; property=&quot;Description&quot; /&gt;
      &lt;field label=&quot;Cost:&quot; property=&quot;Cost&quot; /&gt;
      &lt;field label=&quot;Price:&quot; property=&quot;Price&quot; /&gt;
      &lt;field label=&quot;Stock:&quot; property=&quot;Stock&quot; /&gt;
    &lt;/form&gt;
  &lt;/ui&gt;
&lt;/class&gt;
&lt;/classes&gt;</code></pre>
    </td>
  </tr>
</table>
<p><font face="Verdana" size="2">Finally, the ComputerPart class also needs 
properties to reflect the changes.</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself"><pre><code>public int? Stock
{
    get { return (int?)GetPropertyValue(&quot;Stock&quot;); }
    set { SetPropertyValue(&quot;Stock&quot;, value); }
}

public decimal? Cost
{
    get { return (decimal?)GetPropertyValue(&quot;Cost&quot;); }
    set { SetPropertyValue(&quot;Cost&quot;, value); }
}

public string PartCode
{
    get { return (string)GetPropertyValue(&quot;PartCode&quot;); }
    set { SetPropertyValue(&quot;PartCode&quot;, value); }
}</code></pre></td>
  </tr>
</table>
<p><font face="Verdana" size="2">Check that the project compiles.&nbsp; Once again, if you get an error when you build 
at this stage, check for mistakes like wrong capitalisation, spaces between 
words and types that don't match up.</font></p>
<p><b><font face="Verdana" size="3">Including Customer Orders</font></b></p>
<p><font face="Verdana" size="2">We'll need a new database table for customer 
sales items, called &quot;PartsOrder&quot; (&quot;order&quot; is a sql keyword).&nbsp; Looking at the design, you might ask: 
how do we know which items were ordered? We'll answer that once we've got this 
class up and running.</font></p>
<p align="center">
<img border="0" src="database-partsorder.gif" width="651" height="124"></p>
<p><font face="Verdana" size="2">The corresponding class definitions are here 
below, as listed further down in the classdefs.xml file.&nbsp; When you edit a 
business object using the default editor (DefaultBOEditor/Creator), a one-line 
text field is supplied for each database field.&nbsp; Here we have specified 
that the &quot;Delivered&quot; boolean field will use a &quot;CheckBox&quot; rather 
than the standard TextBox, and that its default value is &quot;false&quot;, to prevent an 
exception if the user does not touch it.&nbsp; You would often need to specify the Habanero 
class that maps this control to the property, but for a handful of standard 
controls the mapper can be assumed.&nbsp; See Appendix I for further clarification on control types 
and their mappers.</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself">
    <pre><code>&lt;class name=&quot;PartsOrder&quot; assembly=&quot;Replace_it&quot;&gt;
  &lt;property name=&quot;PartsOrderID&quot; type=&quot;Guid&quot; /&gt;
  &lt;property name=&quot;OrderNumber&quot; /&gt;
  &lt;property name=&quot;Name&quot; /&gt;
  &lt;property name=&quot;TotalCharge&quot; type=&quot;Decimal&quot; /&gt;
  &lt;property name=&quot;Delivered&quot; type=&quot;Boolean&quot; default=&quot;false&quot; /&gt;
  &lt;primaryKey&gt;
    &lt;prop name=&quot;PartsOrderID&quot; /&gt;
  &lt;/primaryKey&gt;
  &lt;ui&gt;
    &lt;grid&gt;
      &lt;column heading=&quot;Order Number&quot; property=&quot;OrderNumber&quot; /&gt;
      &lt;column heading=&quot;Name&quot; property=&quot;Name&quot; /&gt;
      &lt;column heading=&quot;Delivered&quot; property=&quot;Delivered&quot; /&gt;
    &lt;/grid&gt;
    &lt;form height=&quot;100&quot; width=&quot;300&quot; title=&quot;Add an order&quot;&gt;
      &lt;field label=&quot;Order Number:&quot; property=&quot;OrderNumber&quot; /&gt;
      &lt;field label=&quot;Name:&quot; property=&quot;Name&quot; /&gt;
      &lt;field label=&quot;Total Charge:&quot; property=&quot;TotalCharge&quot; /&gt;
      &lt;field label=&quot;Delivered:&quot; property=&quot;Delivered&quot; type=&quot;CheckBox&quot;/&gt;
    &lt;/form&gt;
  &lt;/ui&gt;
&lt;/class&gt;</code></pre>
    </td>
  </tr>
</table>
<p><font face="Verdana" size="2">And the PartsOrder class to be added:</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeclass">
    <font size="2"><b>PartsOrder.cs</b></font></td>
  </tr>
  <tr>
    <td width="100%" class="codeitself">
    <pre><code>using System;
using Habanero.Bo;

namespace Replace_it
{
public class PartsOrder : BusinessObject
{
    public Guid? PartsOrderID
    {
        get { return (Guid?)GetPropertyValue(&quot;PartsOrderID&quot;); }
        set { SetPropertyValue(&quot;PartsOrderID&quot;, value); }
    }

    public int? OrderNumber
    {
        get { return (int?)GetPropertyValue(&quot;OrderNumber&quot;); }
        set { SetPropertyValue(&quot;OrderNumber&quot;, value); }
    }

    public string Name
    {
        get { return (string)GetPropertyValue(&quot;Name&quot;); }
        set { SetPropertyValue(&quot;Name&quot;, value); }
    }

    public decimal? TotalCharge
    {
        get { return (decimal?)GetPropertyValue(&quot;TotalCharge&quot;); }
        set { SetPropertyValue(&quot;TotalCharge&quot;, value); }
    }

    public bool? Delivered
    {
        get { return (bool?)GetPropertyValue(&quot;Delivered&quot;); }
        set { SetPropertyValue(&quot;Delivered&quot;, value); }
    }
}
}</code></pre>
    </td>
  </tr>
</table>
<p><font face="Verdana" size="2">In order to access the different data tables, 
we'll need to add a menu to the window.&nbsp; We'll refactor out the common code 
to load the business object collection, placing it in the method 
SetBOCollection(), which takes a business object that will be used as a template 
to create a business object collection and load all the objects held in the 
database with that type.&nbsp; To display a different data set, we simply 
specify a different business object collection for the ReadOnlyGrid.&nbsp; We'll 
also add a method to create a main menu with options to view each of our data 
collections.&nbsp; The three methods in Form1.cs now look as follows, and the 
application should run successfully, allowing you to navigate between the two 
tables and add and edit entries.</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself">
    <pre><code>private ReadOnlyGridWithButtons grid;

public Form1()
{
    SetBounds(0,0,640,480);
    CreateMainMenu();
    InitializeComponent();

    BorderLayoutManager manager = new BorderLayoutManager(this);
    SetBOCollection(new ComputerPart());
    manager.AddControl(grid, BorderLayoutManager.Position.Centre);
}

private void CreateMainMenu()
{
    MainMenu menu = new MainMenu();
    MenuItem fileMenu = new MenuItem(&quot;&amp;Data&quot;);
    fileMenu.MenuItems.Add(new MenuItem(&quot;Computer &amp;parts&quot;, delegate
        { SetBOCollection(new ComputerPart()); }));
    fileMenu.MenuItems.Add(new MenuItem(&quot;Customer &amp;orders&quot;, delegate
        { SetBOCollection(new PartsOrder()); }));

    menu.MenuItems.Add(fileMenu);
    Menu = menu;
}

private void SetBOCollection(BusinessObject bo)
{
    BusinessObjectCollection&lt;BusinessObject&gt; boCollection = new BusinessObjectCollection&lt;BusinessObject&gt;(bo);
    boCollection.Load(&quot;&quot;, &quot;&quot;);

    grid = new ReadOnlyGridWithButtons();
    grid.SetCollection(boCollection);
}</code></pre>
    </td>
  </tr>
</table>
<p><b><font face="Verdana" size="3">Introducing Multiple Relationships</font></b></p>
<p>Listing the items bought and sold presents an interesting challenge.&nbsp; We 
need a variable list of items, each storing the product and the quantity 
purchased.&nbsp; For the sake of data integrity and error checking, this would 
best be accomplished through a table.&nbsp; We'll design a table that will hold 
those two pieces of data, along with an ID number and a foreign key pointing 
back to the order number.&nbsp; In a simplistic version, we might just have a 
PartCode string property to store the part code, but later on we'll develop a 
more robust system, so ComputerPartID will become useful further on. Here is the 
table layout for the &quot;OrderItem&quot;:</p>
<p align="center">
<img border="0" src="database-orderitem.gif" width="649" height="100"></p>
<p align="left">Specifying the foreign key in the database is not strictly 
necessary, since your Habanero-based application will still run successfully 
without it, but it is considered good practice to include it, since it can help 
reduce the likelyhood of further error creeping in.&nbsp; The foreign key needs to refer to a primary key, so we'll point 
it to the ID of PartsOrder, even though we know that effectively the 
OrderNumber will be the matching column.</p>
<p align="center">
<img border="0" src="database-orderitem-fk.gif" width="660" height="179"></p>

<font face="Verdana" size="2">

<p>In Habanero, these kinds of relationships between tables are managed using 
Single or Multiple Relationships.&nbsp; We'll need to specify the relationships 
in the class definitions.&nbsp; The relationship between orders and order items are multiple 
rather than single, since we may have many items in an order.&nbsp; The 
class definition xml code to insert just after the PartsOrder's primary key definition is:</p>
<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>&lt;relationship name=&quot;OrderItems&quot; type=&quot;multiple&quot; relatedClass=&quot;OrderItem&quot; relatedAssembly=&quot;Replace_it&quot;&gt;
  &lt;relatedProperty property=&quot;PartsOrderID&quot; relatedProperty=&quot;PartsOrderID&quot; /&gt;
&lt;/relationship&gt;</code></pre>
</td>

</font>

  </tr>
</table>
<p>We'll need class definitions for  OrderItem, which use a single 
relationship to point back to the parent customer order, since there is one 
order for every order item.&nbsp; The ComputerPartID is useful for the 
developer, but not for the end user, which is why all visible labels refer to 
&quot;Part Code&quot;.</p>
<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>&lt;class name=&quot;OrderItem&quot; assembly=&quot;Replace_it&quot;&gt;
  &lt;property name=&quot;OrderItemID&quot; type=&quot;Guid&quot; /&gt;
  &lt;property name=&quot;ComputerPartID&quot; type=&quot;Guid&quot; /&gt;
  &lt;property name=&quot;Quantity&quot; type=&quot;Int32&quot; /&gt;
  &lt;property name=&quot;PartsOrderID&quot; type=&quot;Guid&quot; /&gt;
  &lt;primaryKey&gt;
    &lt;prop name=&quot;OrderItemID&quot; /&gt;
  &lt;/primaryKey&gt;
  &lt;relationship name=&quot;PartsOrder&quot; type=&quot;single&quot; relatedClass=&quot;PartsOrder&quot; relatedAssembly=&quot;Replace_it&quot;&gt;
    &lt;relatedProperty property=&quot;PartsOrderID&quot; relatedProperty=&quot;PartsOrderID&quot; /&gt;
  &lt;/relationship&gt;
  &lt;ui&gt;
    &lt;grid&gt;
      &lt;column heading=&quot;Part Code&quot; property=&quot;ComputerPartID&quot; /&gt;
      &lt;column heading=&quot;Quantity&quot; property=&quot;Quantity&quot; /&gt;
    &lt;/grid&gt;
    &lt;form height=&quot;200&quot; width=&quot;300&quot; title=&quot;Add an ordered item&quot;&gt;
      &lt;field label=&quot;Part Code:&quot; property=&quot;ComputerPartID&quot; /&gt;
      &lt;field label=&quot;Quantity:&quot; property=&quot;Quantity&quot; /&gt;
    &lt;/form&gt;
  &lt;/ui&gt;
&lt;/class&gt;</code></pre>
</td>

</font>

  </tr>
</table>
<p>The  OrderItem class will need an additional constructor to assign the 
ID of the parent PartsOrder and an additional method to return the parent 
order relating to an order item.&nbsp; The PartCode property uses a Guid data 
type - we would usually use a string, but a Guid will become useful later in the 
tutorial.</p>

<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeclass">
      <b><font face="Verdana,Arial,Helvetica" size="2">OrderItem.cs</font></b> </td>

</font>

  </tr>
  <tr>
    <td width="100%" class="codeitself">

<font face="Verdana">

    <pre><code>using System;
using Habanero.Bo;

namespace Replace_it
{
    public class OrderItem : BusinessObject
    {
        public OrderItem() { }

        public OrderItem(PartsOrder partsOrder)
        {
            PartsOrderID = partsOrder.PartsOrderID;
        }

        public PartsOrder PartsOrder
        {
            get { return (PartsOrder)Relationships.GetRelatedBusinessObject(&quot;PartsOrder&quot;); }
        }

        public Guid? OrderItemID
        {
            get { return (Guid?)GetPropertyValue(&quot;OrderItemID&quot;); }
            set { SetPropertyValue(&quot;OrderItemID&quot;, value); }
        }

        public Guid? ComputerPartID
        {
            get { return (Guid?)GetPropertyValue(&quot;ComputerPartID&quot;); }
            set { SetPropertyValue(&quot;ComputerPartID&quot;, value); }
        }

        public int? Quantity
        {
            get { return (int?)GetPropertyValue(&quot;Quantity&quot;); }
            set { SetPropertyValue(&quot;Quantity&quot;, value); }
        }

        public Guid? PartsOrderID
        {
            get { return (Guid?)GetPropertyValue(&quot;PartsOrderID&quot;); }
            set { SetPropertyValue(&quot;PartsOrderID&quot;, value); }
        }
    }
}</code></pre>
</font></td>
  </tr>
</table>
<p>PartsOrder will require an additional method to return the collection of 
its associated order items (between the quotes we specify the relationship name 
as defined in the class definitions):</p>

<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>public BusinessObjectCollection&lt;BusinessObject&gt; OrderItems
{
    get { return Relationships.GetRelatedBusinessObjectCol(&quot;OrderItems&quot;); }
}</code></pre>
</td>

</font>

  </tr>
</table>
<p>At this stage the application should compile successfully, but the user 
interface will now need to be adapted to list the ordered items.&nbsp; One 
efficient way to display the two sets of information (the customer orders and 
the items for each order) is to have two grids, so that clicking on the customer 
order grid will cause the order items grid below it to show the items for that 
order.</p>

<p>The principle challenge here is to copy across the  PartsOrderID (which is the key on which the relationship is matched) when a 
new item is added.&nbsp; To achieve that we'll build our own object creator, 
instead of the DefaultBOCreator provided.&nbsp; Because the creator is generic 
and won't know which order is currently selected, we'll pass that information in 
the constructor.&nbsp; In the CreateObject(editor, uiDefName) method, we use the default 
editor to provide the default form in which the fields are edited.</p>

<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeclass"><b><font size="2">
    OrderItemCreator.cs</font></b></td>
  </tr>
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">

<pre><code>using System;
using Habanero.Base;

namespace Replace_it
{
public class OrderItemCreator : IObjectCreator
{
    private PartsOrder parentObject;

    public OrderItemCreator()
    {
        parentObject = null;
    }

    public OrderItemCreator(PartsOrder partsOrder)
    {
        parentObject = partsOrder;
    }

    public Object CreateObject(IObjectEditor editor, string uiDefName)
    {
        if (parentObject != null)
        {
            OrderItem orderItem = new OrderItem(parentObject);
            if (editor.EditObject(orderItem, uiDefName))
                return orderItem;
        }
        return null;
    }

    public Object CreateObject(IObjectEditor editor, IObjectInitialiser initialiser, string uiDefName)
    {
        return CreateObject(editor, uiDefName);
    }
}
}</code></pre>
</td>



  </tr>
</table>
<p>The Form1 class is restructured somewhat at this stage.&nbsp; An event 
handler is added so that changing the customer order in the top grid will change 
the business object collection in the bottom grid, as well as changing the 
object creator (and specifying the parent customer order).</p>

<table class="code" border="1" cellspacing="0" width="711">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="705" class="codeitself">
    <pre><code>private ReadOnlyGridWithButtons grid;
private ReadOnlyGridWithButtons orderItemsGrid;

public Form1()
{
    SetBounds(0,0,640,480);
    CreateMainMenu();
    InitializeComponent();

    ShowComputerParts();
}

private void CreateMainMenu()
{
    MainMenu menu = new MainMenu();
    MenuItem fileMenu = new MenuItem(&quot;&amp;Data&quot;);
    fileMenu.MenuItems.Add(new MenuItem(&quot;Computer &amp;parts&quot;, delegate
        { ShowComputerParts(); }));
    fileMenu.MenuItems.Add(new MenuItem(&quot;Customer &amp;orders&quot;, delegate
        { ShowOrders(new PartsOrder()); }));

    menu.MenuItems.Add(fileMenu);
    Menu = menu;
}

private void SetBOCollection(BusinessObject bo)
{
    BusinessObjectCollection&lt;BusinessObject&gt; boCollection = new BusinessObjectCollection&lt;BusinessObject&gt;(bo);
    boCollection.Load(&quot;&quot;, &quot;&quot;);

    grid = new ReadOnlyGridWithButtons();
    grid.SetCollection(boCollection);
}

private void ShowComputerParts()
{
    BorderLayoutManager manager = new BorderLayoutManager(this);
    SetBOCollection(new ComputerPart());
    orderItemsGrid = null;
    manager.AddControl(grid, BorderLayoutManager.Position.Centre);
}

private void ShowOrders(BusinessObject bo)
{
    SetBOCollection(bo);
    
    BorderLayoutManager manager = new BorderLayoutManager(this);
    manager.AddControl(grid, BorderLayoutManager.Position.Centre);

    orderItemsGrid = new ReadOnlyGridWithButtons();
    SetOrderItemsCollection();
    manager.AddControl(orderItemsGrid, BorderLayoutManager.Position.South);

    grid.ItemSelected += delegate{ SetOrderItemsCollection(); };
}

private void SetOrderItemsCollection()
{
    PartsOrder selectedOrder = (PartsOrder)grid.SelectedBusinessObject;
    if (selectedOrder != null)
        orderItemsGrid.SetCollection(selectedOrder.OrderItems);
    orderItemsGrid.Buttons.ObjectCreator = new OrderItemCreator(selectedOrder);
}</code></pre>
</td>

</font>

  </tr>
</table>
<p>When run the application should appear something like the following:</p>

<p align="center">
<img border="0" src="app-custorder.gif" width="405" height="327"></p>

<font face="Verdana" size="2">

<font face="Verdana,Arial,Helvetica" size="2">

<p><b><font size="3">Further Exercises</font></b></p>
<p><font size="2">If you are looking to experiment, you could:</font></p>
<ul>
  <li>Recalculate the customer's order charge as each item is added to the order</li>
  <li>Have the order items displayed in a grid on the editor form rather - 
  create your own editor by inheriting from IObjectEditor and setting the editor 
  using &quot;</font><font face="Courier New" size="2">orderItemsGrid.Buttons.ObjectEditor 
  = new ...</font><font face="Verdana,Arial,Helvetica" size="2">&quot;</font></li>
</ul>

</font>

<p>&nbsp;</p>
<p>&nbsp;</p>
<hr>
<table border="1" cellpadding="6" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber11" bgcolor="#F2F2F2">
  <tr>
    <td width="100%" bgcolor="#2F2F84"><b>
    <font face="Verdana" color="#FFFFFF" size="4"><a name="Step4">Step 4:  User Interface Enhancements</a></font></b></td>
  </tr>
  <tr>
    <td width="100%"><font size="2">We'll continue to explore ways to enhance 
    the user's ability to edit objects:<ul>
  <li>Adding lookup-lists in a combo-box</li>
  <li>Fulfilling customer orders</li>
  <li>Better number control</li>
  <li>Filtering grid displays</li>
</ul> </font>
    </td>
  </tr>
</table>

</font>

<font face="Verdana,Arial,Helvetica" size="2">

<p>Habanero provides some useful user interface functionality.&nbsp; While a lot 
of these features are well used already, it often takes a lot of work to get a 
simple feature up and running.&nbsp; In this section, we'll try Habanero's 
approach to implementing some of these.</p>

<p><b><font size="3">Adding Lookup-Lists in a ComboBox</font></b></p>

<p>The way we specify the part code in the order item is very loose and open to 
user error.&nbsp; It would be safer and easier with a drop-down list with all 
the part-codes available.&nbsp; The list of options to display in a ComboBox can 
be specified explicitly in the class definitions (for instance, gender could be 
a choice of &quot;M&quot; or &quot;F&quot;, or we could use the lookup-list to source the drop-down 
contents.&nbsp; There are three means here: BusinessObjectLookupList, 
which creates a list from a set of loaded business objects, 
DatabaseLookupList, which builds a list from a given sql 
statement, and SimpleLookupList, where a static collection can be specified in 
the class definitions.&nbsp; The BO version has the advantage of avoiding error-prone 
raw sql strings, while the database version has the advantage of setting 
criteria, useful when the list of objects is potentially long.&nbsp; We'll use the BO 
version here.</p>

<p>A lookup-list comprises a set of display-value pairs.&nbsp; The display part is 
shown to the user and the value part is the value actually stored.&nbsp; As far as 
implementation goes, we'll first amend the class definitions, amending our 
former definitions for  OrderItem:</p>

<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>&lt;property name=&quot;ComputerPartID&quot; type=&quot;Guid&quot; &gt;
  &lt;businessObjectLookupList class=&quot;ComputerPart&quot; assembly=&quot;Replace_it&quot; /&gt;
&lt;/property&gt;
...
&lt;field label=&quot;Part Code:&quot; property=&quot;ComputerPartID&quot; type=&quot;ComboBox&quot; /&gt;</code></pre>
    </td>
    </font>
  </tr>
</table>

<p>If we had chosen to use DatabaseLookupList, the property definition 
would be:</p>

<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>&lt;property name=&quot;ComputerPartID&quot; type=&quot;Guid&quot; &gt;
  &lt;databaseLookupList sql=&quot;select ComputerPartID, PartCode from computerpart order by PartCode&quot; /&gt;
&lt;/property&gt;</code></pre>
    </td>
    </font>
  </tr>
</table>

<p>The display section composed by BusinessObjectLookupList uses the 
object's ToString() function, which conveniently allows us to format the 
information.&nbsp; Here is the new ToString() function in ComputerPart:</p>

<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>public override string ToString()
{
    return PartCode + &quot; - &quot; + Description;
}</code></pre>
    </td>
    </font>
  </tr>
</table>

<p>This should now 
run successfully.</p>

<p><b><font size="3">Fulfilling Customer Orders</font></b></p>

<p>Where the Delivered field is set to false, we can now dispatch the order 
and automatically amend the stock quantities.&nbsp; In the anonymous delegate 
for the Customer Orders menu item, a &quot;Dispatch&quot; button is added to the ReadOnlyGridWithButtons as follows:</p>

<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>fileMenu.MenuItems.Add(new MenuItem("Customer &orders", delegate
    {
        ShowOrders(new PartsOrder());
        grid.Buttons.AddButton(&quot;Dispatch&quot;, new EventHandler(DispatchClickedHandler));
    }));</code></pre>
</td>
    </font>
  </tr>
</table>

<p>The DispatchClickedHandler is implemented further along.&nbsp; The parts 
stock is loaded and we check that all of the stock is available before 
decrementing stock levels.&nbsp; Note that we call Save() on the objects in 
order to persist the changes to the database, otherwise our stock will still be 
there the next time we start the application.</p>

<table class="code" border="1" cellspacing="0">
  <tr>

    <td width="100%" class="codeitself">
    <pre><code>private void DispatchClickedHandler(object sender, EventArgs e)
{
    PartsOrder selectedOrder = (PartsOrder)grid.SelectedBusinessObject;
    if (selectedOrder.Delivered.Value || selectedOrder.OrderItems.Count == 0)
        return;

    BusinessObjectCollection&lt;ComputerPart&gt; stockAvailable = new BusinessObjectCollection&lt;ComputerPart&gt;();
    stockAvailable.Load(&quot;&quot;,&quot;&quot;);

    foreach (OrderItem orderItem in selectedOrder.OrderItems)
    {
        ComputerPart matchingPart = stockAvailable.FindByGuid(orderItem.ComputerPartID.Value);
        if (matchingPart == null)
        {
            MessageBox.Show(&quot;Could not find some of the stock on order. Please double-check.&quot;);
            return;
        }
            
        if (orderItem.Quantity &gt; matchingPart.Stock)
        {
            MessageBox.Show(&quot;Insufficient stock of part: &quot; + matchingPart.PartCode);
            return;
        }
    }

    foreach (OrderItem orderItem in selectedOrder.OrderItems)
    {
        ComputerPart matchingPart = stockAvailable.FindByGuid(orderItem.</code><font face="Verdana,Arial,Helvetica" size="2"><code>ComputerPartID.Value</code></font><code>);
        matchingPart.Stock -= orderItem.Quantity;
        matchingPart.Save();
    }
    MessageBox.Show(&quot;Stock dispatched and stock levels amended&quot;);
    selectedOrder.Delivered = true;
    selectedOrder.Save();
}</code></pre>
    </td>
  </tr>
</table>

<p>At this stage we have a basic stock management system.&nbsp; Using Habanero 
we've achieved this with very little contact with either the user interface 
designer or 
the database connections.</p>

<p><b><font size="3">Better Number Control</font></b></p>

<p>While our user interface is functional, it's not very robust, and an 
experimental user could quickly bring our application down to earth.&nbsp; We can exercise some control of our cost input by using NumericUpDown controls.&nbsp; 
There are two Habanero mappers for this control: the default 
NumericUpDownIntegerMapper and the NumericUpDownMoneyMapper, which can be 
assigned a variable number of decimal places.&nbsp; We'll simply assign a 
different control and mapper type and we'll also give these properties a default 
value to prevent a null exception being thrown by the database.</p>

<p>This is also a good time to introduce property rules.&nbsp; In our parts 
business, we obviously don't want a negative stock, so we can create a rule that 
prevents negative integers.&nbsp; A rule can be a combination of smaller rules, 
so that ranges can be created for instance.&nbsp; See Appendix I for a list of 
available rule options.</p>

<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself">
    <pre><code>&lt;property name=&quot;Cost&quot; type=&quot;Decimal&quot; default=&quot;0&quot; /&gt;
&lt;property name=&quot;Price&quot; type=&quot;Decimal&quot; default=&quot;0&quot; /&gt;
&lt;property name=&quot;Stock&quot; type=&quot;Int32&quot; default=&quot;0&quot;&gt;
    &lt;rule name=&quot;No negative stock&quot;&gt;
        &lt;add key=&quot;min&quot; value=&quot;0&quot; /&gt;
    &lt;/rule&gt;
&lt;/property&gt;

...

&lt;field label=&quot;Cost:&quot; property=&quot;Cost&quot; type=&quot;NumericUpDown&quot; mapperType=&quot;NumericUpDownMoneyMapper&quot;/&gt;
&lt;field label=&quot;Price:&quot; property=&quot;Price&quot; type=&quot;NumericUpDown&quot; mapperType=&quot;NumericUpDownMoneyMapper&quot; /&gt;
&lt;field label=&quot;Stock:&quot; property=&quot;Stock&quot; type=&quot;NumericUpDown&quot;/&gt;</code></pre>
</td>
  </tr>
</table>

<p><b><font size="3">Filtering Grid Displays</font></b></p>

<p>Quite clearly, our grid displays could grow rather large as we begin to add 
computer parts or customer orders.&nbsp; There are a few ways to limit the 
number of objects being shown.&nbsp; We could specify load criteria as a 
parameter in each collection's Load() command.&nbsp; Another simple way is to 
add a filter control, which filters out the rows to display, so that only those 
rows that meet a requirement are shown.</p>

<p>Looking first at the computer parts, how you filter your values will depend 
on how you distinguish your parts.&nbsp; For instance, Replace IT uses a part 
code made up of three letters which indicate the type of product and four 
numbers which serve as a sub-code for that type.&nbsp; For example, one of the 
optical mice might have a code of MOU1534.&nbsp; So our solution simply 
categorises items by their three first letters, doing a non-strict string 
comparison.</p>

<p>This code slots in at the bottom of the ShowComputerParts() method.</p>

<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself">
    <pre><code>string[] options = {"CDR", "KEY", "MOU", "HDD", "DVD", "MBD", &quot;FDD&quot;, &quot;CAS&quot;, &quot;MON&quot;, &quot;VID&quot;};
FilterControl filter = new FilterControl(new DataViewFilterClauseFactory());
filter.AddStringFilterComboBox("Category:", "PartCode", new ArrayList(options), false);
filter.FilterClauseChanged += delegate{ grid.Grid.ApplyFilter(filter.GetFilterClause()); };
manager.AddControl(filter, BorderLayoutManager.Position.North);</code></pre>
    </td>
  </tr>
</table>

<p>For the sake of illustration, we can use the Load() method to filter values 
in the orders grids.&nbsp; We'll add a checkbox at the top that allows the user 
to display only those orders that have not been delivered yet.&nbsp; We'll then 
assign a new collection to the grid that has load-criteria.&nbsp; The following 
code is added at the bottom of the ShowOrders() method.</p>

<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself">
    <pre><code>CheckBox checkBox = new CheckBox();
checkBox.Text = "Undelivered orders only";
checkBox.CheckedChanged += delegate
   {
       BusinessObjectCollection&lt;BusinessObject&gt; col =
           new BusinessObjectCollection&lt;BusinessObject&gt;(bo);
       if (checkBox.Checked) col.Load("Delivered = 'false'", "");
       else col.Load("","");
       grid.SetCollection(col);
   };
manager.AddControl(checkBox, BorderLayoutManager.Position.North);</code></pre>
    </td>
  </tr>
</table>

<p><b><font size="3">Further Exercises</font></b></p>
<p><font size="2">If you are looking to experiment, you could:</font></p>
<ul>
  <li>Add a customer table that tracks their orders, so that when you create an 
  order, you choose the customer from a ComboBox list</li>
  <li>Add functionality to track how much profit you are making on your orders</li>
</ul>

</font>

<p>&nbsp;</p>

<p>&nbsp;</p>

<hr>

<table border="1" cellpadding="6" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber13" bgcolor="#F2F2F2">
  <tr>
    <td width="100%" bgcolor="#2F2F84"><b>
    <font face="Verdana" color="#FFFFFF" size="4"><a name="Step5">Step 5: 
    Introducing Inheritance</a></font></b></td>
  </tr>
  <tr>
    <td width="100%"><font size="2">We'll introduce supplier orders using inheritance:



<ul>
  <li>Have SupplierOrder inherit from PartsOrder</li>
  <li>Unloading supplier orders</li>
</ul>
</font>
    </td>
  </tr>
</table>


<p><b><font size="3">Inheritance Strategies</font></b></p>


<p>Inheritance is one distinct feature supported by object-orientation but not 
by relational databases.&nbsp; Habanero as an object relational mapping tool 
translates an inheritance structure to database tables in three different ways.&nbsp; 
The default &quot;ClassTableInheritance&quot; uses one database table per class in the 
inheritance structure. All fields that are inherited from the parent are 
actually stored in the database table of the parent, while the child table only 
stores its ID, the parent's ID and any fields that are unique to the child.&nbsp; 
&quot;SingleTableInheritance&quot; maps all fields of all classes of an inheritance 
structure into a single table. &quot;ConcreteTableInheritance&quot; uses a table for each 
concrete class in the inheritance hierarchy, so that the fields of an abstract 
parent are stored in the child rather.</p>

<p>In our example, supplier orders and customer orders are very similar - they 
both have an order number, name, price, delivery indication and a list of items 
ordered.&nbsp; We'd really like supplier orders to have all the functionality of 
customer orders, or PartsOrders as we called them, but the problem is that 
supplier orders are not a type of customer order.&nbsp; So what we've done - and 
this was really sneaky - was to give CustomerOrders the name PartsOrder.&nbsp; 
Now SupplierOrder and CustomerOrder can inherit from PartsOrder without 
duplicating too much functionality.&nbsp; PartsOrder becomes an abstract class 
that the user will never see.</p>

<p>Now to choose an inheritance strategy.&nbsp; Each one obviously has its pros 
and cons.&nbsp; The advantage of &quot;ClassTableInheritance&quot; is that we're 
not having to duplicate the fields of each inheritor in both the database tables 
and the class definitions - once they've been declared in the parent, they're 
inherited automatically.&nbsp; &quot;SingleTableInheritance&quot; places all the data into 
one table, which does reduce our control over the individual tables.&nbsp; 
&quot;ConcreteTableInheritance&quot; separates the data distinctly but does incur 
duplication.&nbsp; You can imagine that in a class with many fields, this 
duplication can add up to a lot of extra work.&nbsp; We'll go with the default 
for this example, although you may want to experiment with the other structures 
too.</p>

<p><font size="3"><b>Implementing Inheritance</b></font></p>

<p>The first step will be to add database tables for &quot;CustomerOrder&quot; and 
&quot;SupplierOrder&quot;.&nbsp; At this stage you may want to add extra fields relevant 
to the supplier or customer, but for now we'll leave that for some day in the 
distant future.&nbsp; Note that you may run into issues if you already have data 
in the PartsOrder table - just delete all the entries you have for PartsOrder 
and OrderItem.&nbsp; If you're having foreign key conflicts, consider removing 
the foreign key in OrderItem and adding it back after all the changes have been 
made.</p>

<p align="center">
<img border="0" src="database-custorder.gif" width="651" height="270"></p>

<p>&nbsp;</p>

<p align="center">
<img border="0" src="database-suporder.gif" width="650" height="268"></p>

<p>The class definitions are fairly straight-forward, except for the fact that 
we have to list all the columns and fields to display in the user interfaces.&nbsp; 
All we need to do is to delete the ui definitions from PartsOrder and copy them 
equally into SupplierOrder and CustomerOrder.</p>

<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>  &lt;class name=&quot;SupplierOrder&quot; assembly=&quot;Replace_it&quot;&gt;
    &lt;superClass class=&quot;PartsOrder&quot; assembly=&quot;Replace_it&quot; /&gt;
    &lt;property name=&quot;SupplierOrderID&quot; type=&quot;Guid&quot; /&gt;
    &lt;primaryKey&gt;
      &lt;prop name=&quot;SupplierOrderID&quot;/&gt;
    &lt;/primaryKey&gt;
    &lt;ui&gt;
      &lt;grid&gt;
        &lt;column heading=&quot;Order Number&quot; property=&quot;OrderNumber&quot; /&gt;
        &lt;column heading=&quot;Name&quot; property=&quot;Name&quot; /&gt;
        &lt;column heading=&quot;Delivered&quot; property=&quot;Delivered&quot; /&gt;
      &lt;/grid&gt;
      &lt;form height=&quot;200&quot; width=&quot;300&quot; title=&quot;Add a customer order&quot;&gt;
        &lt;field label=&quot;Order Number:&quot; property=&quot;OrderNumber&quot; /&gt;
        &lt;field label=&quot;Name:&quot; property=&quot;Name&quot; /&gt;
        &lt;field label=&quot;Total Charge:&quot; property=&quot;TotalCharge&quot; /&gt;
        &lt;field label=&quot;Delivered:&quot; property=&quot;Delivered&quot; type=&quot;CheckBox&quot;/&gt;
      &lt;/form&gt;
    &lt;/ui&gt;
  &lt;/class&gt;

  &lt;class name=&quot;CustomerOrder&quot; assembly=&quot;Replace_it&quot;&gt;
    &lt;superClass class=&quot;PartsOrder&quot; assembly=&quot;Replace_it&quot; /&gt;
    &lt;property name=&quot;CustomerOrderID&quot; type=&quot;Guid&quot; /&gt;
    &lt;primaryKey&gt;
      &lt;prop name=&quot;CustomerOrderID&quot;/&gt;
    &lt;/primaryKey&gt;
    &lt;ui&gt;
      &lt;grid&gt;
        &lt;column heading=&quot;Order Number&quot; property=&quot;OrderNumber&quot; /&gt;
        &lt;column heading=&quot;Name&quot; property=&quot;Name&quot; /&gt;
        &lt;column heading=&quot;Delivered&quot; property=&quot;Delivered&quot; /&gt;
      &lt;/grid&gt;
      &lt;form height=&quot;200&quot; width=&quot;300&quot; title=&quot;Add a customer order&quot;&gt;
        &lt;field label=&quot;Order Number:&quot; property=&quot;OrderNumber&quot; /&gt;
        &lt;field label=&quot;Name:&quot; property=&quot;Name&quot; /&gt;
        &lt;field label=&quot;Total Charge:&quot; property=&quot;TotalCharge&quot; /&gt;
        &lt;field label=&quot;Delivered:&quot; property=&quot;Delivered&quot; type=&quot;CheckBox&quot;/&gt;
      &lt;/form&gt;
    &lt;/ui&gt;
  &lt;/class&gt;</code></pre>
</td>
    </font>
  </tr>
</table>

<p>Our two new classes, CustomerOrder.cs and SupplierOrder.cs, couldn't be 
simpler:</p>

<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeclass"><b><font size="2">
    CustomerOrder.cs</font></b></td>
    </font>
  </tr>
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">

<pre><code>namespace Replace_it
{
    class CustomerOrder : PartsOrder
    {
    }
}</code></pre>
</td>
</font>
</tr>
</table>



<br>

<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeclass"><b><font size="2">
    SupplierOrder.cs</font></b></td>
    </font>
  </tr>
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">

<pre><code>namespace Replace_it
{
    class SupplierOrder : PartsOrder
    {
    }
}</code></pre>
</td>
</font>
</tr>
</table>



<p>And finally, we have to adjust the code.&nbsp; This tutorial has structured 
the previous code in a way that these changes are going to be fairly easy.&nbsp; We'll 
just change the two menu items, so that &quot;Customer orders&quot; now points at the 
CustomerOrders, and we'll add a menu item for &quot;Supplier orders&quot;:</p>

<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>fileMenu.MenuItems.Add(new MenuItem("Customer &orders", delegate
    {
        ShowOrders(new CustomerOrder());
        grid.Buttons.AddButton("Dispatch", new EventHandler(DispatchClickedHandler));
    }));
fileMenu.MenuItems.Add(new MenuItem("&Supplier orders", delegate
    {
        ShowOrders(new SupplierOrder());
        grid.Buttons.AddButton("Receive", new EventHandler(DispatchClickedHandler));
    }));</code></pre></td>
    </font>
  </tr>
</table>



<p>The method to handle a &quot;Receive&quot; button click is as follows:</p>



<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>private void ReceiveClickedHandler(object sender, EventArgs e)
{
    PartsOrder selectedPartsOrder = (PartsOrder)grid.SelectedBusinessObject;
    if (selectedPartsOrder.Delivered.Value || selectedPartsOrder.OrderItems.Count == 0)
        return;

    BusinessObjectCollection<ComputerPart> stockAvailable = new BusinessObjectCollection<ComputerPart>();
    stockAvailable.Load("", "");

    foreach (OrderItem orderItem in selectedPartsOrder.OrderItems)
    {
        ComputerPart matchingPart = stockAvailable.FindByGuid(orderItem.ComputerPartID.Value);
        if (matchingPart == null)
        {
            MessageBox.Show("Could not find some of the stock on order. Please double-check.");
            return;
        }
    }

    foreach (OrderItem orderItem in selectedPartsOrder.OrderItems)
    {
        ComputerPart matchingPart = stockAvailable.FindByGuid(orderItem.ComputerPartID.Value);
        matchingPart.Stock += orderItem.Quantity;
        matchingPart.Save();
    }
    MessageBox.Show("Stock received and stock levels amended");
    selectedPartsOrder.Delivered = true;
    selectedPartsOrder.Save();
}</code></pre></td>
    </font>
  </tr>
</table>



<p>That should give you a working application.</p>



<font face="Verdana,Arial,Helvetica" size="2">

<p><b><font size="3">Further Exercises</font></b></p>
<p><font size="2">If you are looking to experiment, you could:</font></p>
<ul>
  <li>Implement the above solution with the other inheritance strategies.</li>
  <li>Add a button in the supplier section that allows you to return faulty 
  stock.</li>
  <li>While adding a new supplier order, add the ability to create a new 
  computer part when you encounter a part that's new to the catalogue.</li>
</ul>

</font>



<p>&nbsp;</p>



<p>&nbsp;</p>

<p>&nbsp;</p>

<font face="Verdana,Arial,Helvetica" size="2">

<hr>
</font>

<p>&nbsp;</p>

<font face="Verdana,Arial,Helvetica" size="2">

<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself"><pre><code>template</code></pre></td>
  </tr>
</table>

<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeclass"><b><font size="2">
    OrderItemCreator.cs</font></b></td>
  </tr>
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">

<pre><code>class template</code></pre>
</td>
</tr>
</table>



<p><b><font size="2">Task list:</font></b></p>
<ul>
  <li><font size="2">X- create customer table (adapt customerorder to refer to 
  customer number, when you create new order, have option to create new customer 
  with popup window, in customer table maintain list of orders with related 
  field)</font></li>
  <li><font size="2">login to application, check synchronisation (maintain 
  permissions list?)</font></li>
  <li><font size="2">progress indicators</font></li>
  <li><font size="2">error messaging</font></li>
  <li>version upgrader/dbmigrator</li>
  <li>using Habanero without the GUI application</li>
  <li>fix &quot;using&quot;s</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr>
<table border="1" cellpadding="7" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber3" bgcolor="#E4E4E4">
  <tr>
    <td width="100%">

<font face="Verdana,Arial,Helvetica">

    <b><font face="Verdana" size="4"><a name="AppendixI">Appendix I - Class 
Definitions</a></font></b></font></td>
  </tr>
</table>
<p><b>Class definitions for: Habanero Beta v1.0</b></p>
<p>This section covers a list of explanations, possible options and 
limitations for all class definitions as listed in the class definitions XML 
file (usually called &quot;classdefs.xml&quot;).&nbsp; The class definitions are 
required in order for Habanero to run, and you need to include the definitions 
for at least one valid class.</p>
<p>This is a sample structure for a class definition file.&nbsp; Note that the 
order of elements is enforced as per the Document Type Definition (DTD).&nbsp; See the 
specifications further along for specific options and limitations.</p>
<table border="1" cellpadding="4" cellspacing="0" style="border-collapse: collapse" bordercolor="#808080" width="100%" id="AutoNumber4">
  <tr>
    <td width="100%" bgcolor="#D7EBF4"><font size="2"><b>Sample Structure:</b></font></td>
  </tr>
  <tr>
    <td width="100%">
    <pre><code>&lt;classes&gt;
&lt;class name=&quot;class_name&quot; assembly=&quot;assembly_name&quot;&gt;
  &lt;superClass class=&quot;class_inherited_from&quot; assembly=&quot;its_assembly&quot; /&gt;

  &lt;property name=&quot;property_name&quot; /&gt;
  &lt;property name=&quot;property_name&quot; type=&quot;Guid&quot; isCompulsory=&quot;true&quot;&gt;
    &lt;rule name=&quot;rule_name&quot; /&gt;
      &lt;add key=&quot;max&quot; value=&quot;300&quot;&gt;
    &lt;/rule&gt;
    &lt;databaseLookupList sql=&quot;select display_field, value_field from table_name&quot; /&gt;
  &lt;/property&gt;

  &lt;key name=&quot;keydef_name&quot; ignoreNulls=&quot;true&quot;&gt;
    &lt;prop name=&quot;property_name&quot; /&gt;
  &lt;/key&gt;

  &lt;primaryKey&gt;
    &lt;prop name=&quot;primary_key_name&quot; /&gt;
  &lt;/primaryKey&gt;

  &lt;relationship name=&quot;rel_name&quot; type=&quot;multiple&quot; relatedClass=&quot;class&quot; relatedAssembly=&quot;assembly&quot;&gt;
    &lt;relatedProperty name=&quot;related_prop_name&quot; relatedProperty=&quot;related_prop_name&quot; /&gt;
  &lt;/relationship&gt;

  &lt;ui&gt;
    &lt;grid&gt;
      &lt;column heading=&quot;column_heading&quot; property=&quot;property_name&quot; width=&quot;100&quot; /&gt;
    &lt;/grid&gt;
    &lt;form height=&quot;400&quot; width=&quot;450&quot; heading=&quot;edit_form_heading&quot;&gt;
      &lt;tab name=&quot;form_name&quot;&gt;
        &lt;columnLayout width=&quot;350&quot;&gt;
          &lt;field label=&quot;label&quot; property=&quot;prop_name&quot; editable=&quot;false&quot; /&gt;
        &lt;/columnLayout&gt;
        &lt;columnLayout&gt;
          &lt;field label=&quot;label&quot; property=&quot;prop_name&quot; type=&quot;ComboBox&quot; mapperType=&quot;ListComboBoxMapper&quot;&gt;
            &lt;parameter name=&quot;options&quot; value=&quot;F|M&quot; /&gt;
          &lt;/field&gt;
        &lt;/columnLayout&gt;
      &lt;/tab&gt;
      &lt;tab name=&quot;form_name2&quot;&gt;
        &lt;field label=&quot;label&quot; property=&quot;prop_name&quot; type=&quot;TextBox&quot; /&gt;
      &lt;/tab&gt;
    &lt;/form&gt;
  &lt;/ui&gt;	
&lt;/class&gt;
&lt;/classes&gt;</code></pre>
    </td>
  </tr>
</table>
<p>Here follows a list of all the class definition elements.&nbsp; For 
clarification, &quot;attribs&quot; means attributes and  the default settings are 
in italics.&nbsp; Keep in mind that XML elements are case-sensitive.</p>
<table border="1" cellpadding="5" cellspacing="0" style="border-collapse: collapse" bordercolor="#808080" width="100%" id="AutoNumber4">
  <tr>

    <td width="100%" bgcolor="#D7EBF4" colspan="2"><b>Class Definition 
    Specifications<font size="2"><br>
&nbsp;</font></b><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber8">
      <tr>
        <td width="25%">

<font face="Verdana,Arial,Helvetica" size="2">

        <font size="2"><a href="#add">add</a></font><br>
</font>

        <font size="2">
        <a href="#businessObjectLookupList">businessObjectLookupList</a><br>
        <a href="#class">class</a><br>
        <a href="#classes">classes</a></font><br>

<font face="Verdana,Arial,Helvetica" size="2">

        <font size="2">
        <a href="#column">column</a></font></font><br>

<font face="Verdana,Arial,Helvetica" size="2">

        <font size="2" face="Verdana,Arial,Helvetica"><a href="#columnLayout">columnLayout</a></font></td>
        <td width="25%">

<font face="Verdana,Arial,Helvetica" size="2">

        <font size="2">
        <a href="#databaseLookupList">databaseLookupList</a><br>
        <a href="#field">field</a></font><br>
        <font size="2"><a href="#form">form</a><br>
        <a href="#grid">grid</a></font><br>
<a href="#item">item</a><br>

        <font size="2" face="Verdana,Arial,Helvetica">
        <a href="#key">key</a></font></td>
        <td width="25%">

<font face="Verdana,Arial,Helvetica" size="2">

        <a href="#parameter">parameter</a><font size="2"><br>
        <a href="#primaryKey">primaryKey</a></font></font><br>

<font face="Verdana,Arial,Helvetica" size="2">

        <font size="2">
        <a href="#prop">prop</a></font><br>
        <font size="2"><a href="#property">property</a><br>
        <a href="#relationship">relationship</a></font></font><br>
        <font size="2">
        <a href="#relatedProperty">relatedProperty</a></font></td>
        <td width="25%" valign="top">
        <font size="2" face="Verdana,Arial,Helvetica"><a href="#rule">rule</a><br>
        <a href="#simpleLookupList">simpleLookupList</a><br>
        <a href="#superClass">superClass</a></font><font size="2"><br>
        <a href="#tab">tab</a><br>
        </font><font size="2" face="Verdana,Arial,Helvetica">
        <a href="#ui">ui</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="17%" class="specclass">
    <b><a name="classes" class="specclasslink">classes</a> </b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">The root element of the xml document. Contains one 
        class element for each class/table.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">class (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom">-</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>
  
  <tr>
    <td class="specclass">
    <b><a name="class" class="specclasslink">class</a> </b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Contains a definition for each class/table.&nbsp; 
        Holds property definitions, primary key definitions, relationships and 
        how the data is displayed in the user interface.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">classes</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">property (1..*)<br>
        primaryKey (1)</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">superClass (1)<br>
        key (1..*)<br>
        relationship (1..*)<br>
        ui (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>name</b> (name of the class in the assembly/project)<br>
        <b>assembly</b> (name of the assembly/project)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>table</b> (table name in database, otherwise 
        assumed to be the class name)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>
  <tr>
  	<td class="specclass">
    <b><a name="superClass" class="specclasslink">superClass</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Indicates which class this class inherits from and 
        the type of inheritance used. ClassTableInheritance uses one database 
        table per class in the inheritance structure. SingleTableInheritance 
        maps all fields of all classes of an inheritance structure into a single 
        table. ConcreteTableInheritance uses a table for each concrete class in 
        the inheritance hierarchy.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">class</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>class</b> (the class name from which the class 
        inherits)<br>
        <b>assembly</b> (the assembly/project containing the super-class)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>orMapping</b> =<i>ClassTableInheritance</i>/SingleTableInheritance/ConcreteTableInheritance 
        (the type of inheritance used)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b><a name="property" class="specclasslink">property</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Defines an individual property or field name in a 
        class.&nbsp; Specifies what the data type is, whether there is a 
        specific list of options to choose from or whether there are any property rules or 
        limitations on the property values. At the very least, the property to 
        be used for the primary key definition needs to be defined.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">class</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">rule (0..*)<br>
        databaseLookupList (1)<br>
        businessObjectLookupList (1)<br>
        simpleLookupList (1)</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>name</b> (the name of the property as listed in the 
        code)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>type</b> =<i>String</i>/Guid/Int32/Boolean/Decimal/DateTime/etc (the data 
        type at code level, standard names like 'int' are also valid, you can add your own types if desired)<br>
        <b>assembly</b> =<i>System</i> (the assembly to which the property type belongs)<br>
        <b>databaseField</b> (if the field name is different to the property name)<br>
        <b>default</b> (any default value to be assigned)<br>
        <b>compulsory</b> =true/<i>false</i> (whether assigning a value is compulsory, 
        will make the field's label bold and provide error messaging to the user 
        if not completed)<br>
        <b>readWriteRule</b> =<i>ReadWrite/</i>ReadOnly/WriteOnce 
        (limitations on how often the value can be read or written to)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	  	<td class="specclass">
    <b><a name="rule" class="specclasslink">rule</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Sets specific rules that a string value must 
        adhere to.&nbsp; This element holds the name of the rule and a message 
        to display to the user if the rule is broken.&nbsp; A single rule can 
        therefore be a combination of several cases.&nbsp; You can also add 
        rules of your own by creating a class that inherits from 
        Habanero.Bo.PropRuleBase, and specifying this class here. See the 'add' 
        element on a list of rules currently available.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">property</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">add (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>name</b> (the name of the rule, for the user's 
        reference)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>message</b> (to display to the user if the rule 
        is broken)<br>
        <b>class</b> (a class that carries out checking against a custom rule)<br>
        <b>assembly</b> (the assembly holding the above class)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	  	<td class="specclass">
    <b><a name="add" class="specclasslink">add</a> </b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">A key-value pair that sets a single rule that the 
        property value must adhere 
        to.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">rule</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>key</b> (the name of the rule, eg. &quot;max&quot;)<br>
        <b>value</b> (the value applicable to the rule, eg. &quot;300&quot;)
        <br><br>
        The following options are available, depending on the property type you 
        specified:<br><br>
        <table border="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#C0C0C0" width="100%" id="AutoNumber7" class="options">
          <tr>
            <td width="100" class="options">string</td>
            <td class="options">minLength (minimum number of characters)<br>
            maxLength (maximum number of characters)<br>
            patternMatch (a regular expression to match to)</td>
          </tr>
          <tr>
            <td class="options">DateTime</td>
            <td class="options">min (earliest date allowed)<br>
            max (latest date allowed)</td>
          </tr>
          <tr>
            <td class="options">decimal/int</td>
            <td class="options">min<br>
            max</td>
          </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom">-</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	  	<td class="specclass">
    <b><a name="databaseLookupList" class="specclasslink">databaseLookup-<br>List</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Provides a list of potential values for the property, using 
        the objects loaded from the database with the given sql statement.&nbsp; 
        Two fields must be provided in the form of a display-value pair, meaning 
        that the first is the value to display to the user (eg. in a ComboBox or 
        grid) and the second is the value to be stored for the property, which 
        is useful when you are using Guids.&nbsp; The sql statement needs to be in the form of: &quot;select 
         
        valueField, displayField 
        from tableName&quot;.&nbsp; An order-by clause can also be appended.&nbsp; 
        The class and assembly will seldom need to be specified.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">property</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>sql</b> (the select sql statement to load the objects 
        to populate the list)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>class</b> (the class for the objects being loaded)<br>
        <b>assembly</b> (the assembly/project for the objects being loaded)<br>
        <b>timeout</b> (the period in seconds after which a query times out)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	  	<td class="specclass">
    <b><a name="simpleLookupList" class="specclasslink">simpleLookupList</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Provides a list of potential values for the 
        property.&nbsp; You can  specify a list of options in the 
        &quot;options&quot; attribute, separated by pipes, and/or you can include  sets of 
        display-value pairs in  &quot;item&quot; elements, that have the advantage of 
        displaying a different value to the one actually stored (eg. store a 
        Guid in the database, but display a string in a 
        ComboBox or grid).</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">property</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">item (0..*)</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>options</b> (a list of options, eg. 
        &quot;Male|Female|Not-specified&quot;)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b><a name="item" class="specclasslink">item</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">A display-value pair  that serves as one 
        option in a simpleLookupList.&nbsp; The display attribute appears to the user 
        (eg. in the ComboBox or grid), while the value attribute is the value 
        stored.&nbsp; This is a useful option when a Guid is being stored.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">simpleLookupList</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>display</b> (the value that will appear to the user in 
        a form or grid)<br>
        <b>value</b> (the value that will be stored for the property)
        </td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom">-</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	  	<td class="specclass">
    <b><a name="businessObjectLookupList" class="specclasslink">businessObject-<br>LookupList</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Provides a list of potential values for the property, using 
        the objects loaded from a particular business object type.&nbsp; This 
        function will only work if the primary key of the class is of a Guid 
        type.&nbsp; The Guid value will be the actual value stored, while the 
        value displayed to the user (eg. in the ComboBox or grid) will be that 
        obtained from the object's ToString() method. You can also set criteria 
        to limit which objects are loaded.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">property</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>class</b> (the business object class  for the 
        objects to be loaded)<br>
        <b>assembly</b> (the assembly holding the above class)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>criteria</b> (a sql segment to be attached to a 
        where-clause that limits which objects are loaded)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

  	<td class="specclass">
    <b><a name="key" class="specclasslink">key</a></b></td>
    </font>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Specifies a unique key for the class/table, 
        which is a property or combination of properties which must be unique 
        for each instance/row.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">class</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">prop (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>name</b> (a name that describes the key)<br>
        <b>message</b> (to explain why a write operation violates the key)<br>
        <b>ignoreIfNull</b> =true/<i>false</i> (whether to ignore the uniqueness 
        check if any of the properties making up the key are null)</td>
      </tr>
    </table>
    </font>
    </td>
    </font>
  </tr>

  <tr>
  	<td class="specclass">
    <b><a name="primaryKey" class="specclasslink">primaryKey</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Describes the primary key for the class, using  
        properties that have been defined in the property elements. The &quot;prop&quot; 
        sub-elements list the properties that the primary key is comprised of (a 
        composite primary key will have more than one prop element).</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">class</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">prop (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>isObjectId</b> =<i>true</i>/false (whether this 
        key is the object ID, false for composite keys)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b><a name="prop" class="specclasslink">prop</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Specifies the existing property definition being 
        referred to in the composition of a primary key or alternate key</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">primaryKey, key</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>name</b> (the name of the existing property definition 
        being referred to)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom">-</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b><a name="relationship" class="specclasslink">relationship</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Describes a relationship between this class and 
        another class (equivalent to foreign keys in a database). Note that the 
        relationship is mapped between a particular property in one class and a 
        primary key property in another class.&nbsp; For the delete action, 
        DeleteRelated deletes all related objects when one is deleted, 
        DereferenceRelated dereferences them instead, and Prevent prevents the 
        object from being deleted when other objects related to it.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">class</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">relatedProperty (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>name</b> (the name of the relationship)<br>
        <b>type</b> =single/multiple (if this class relates to one or many of the other 
        class)<br>
        <b>relatedClass</b> (the related class name)<br>
        <b>relatedAssembly</b> (the assembly/project containing the related class)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>keepReference</b> =<i>true</i>/false 
        (keep a reference in memory to the class, can set this to false if your 
        application is very memory-intensive)<br>
        <b>orderBy</b> (the field name(s) to append to the sql order-by clause)<br>
        <b>deleteAction</b> =DeleteRelated/DereferenceRelated/<i>Prevent</i> (what action to take  when the related object is 
        deleted)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <a name="relatedProperty" class="specclasslink">
    <b>relatedProperty </b></a></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Defines the properties on which relationship 
        matching takes place.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">relationship</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>property</b> (the property in this class which relates to 
        the other class)<br>
        <b>relatedProperty</b> (the property in the other class being related to)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom">-</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b><a name="ui" class="specclasslink">ui</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Defines how the class is displayed in user 
        interfaces like grids and editing forms.&nbsp; If you will only use one 
        set of UI definitions, you do not need to assign a &quot;name&quot; attribute.&nbsp; 
        If you want to be able to choose between different sets of definitions 
        at different times, assign different names and then use constructors in 
        the IGridDataProvider implementations to choose the name of the 
        definition to use.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">class</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">grid (1)<br>
        form (1)</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>name</b> =<i>default </i>(the name of the set of definitions)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b>
    <a name="grid" class="specclasslink">grid</a></b></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Defines how the class properties are displayed in 
        a user interface grid, with one column element for each column 
        to display.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">ui</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">column (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom">-</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b><a name="column" class="specclasslink">column</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Defines one column of data in a user interface 
        grid.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">grid</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>heading</b> (the column heading as seen by the user)<br>
        <b>property</b> (the name of the property being shown)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>type</b> =<i>DataGridViewTextBoxColumn</i>/DataGridViewCheckBoxColumn/ DataGridViewComboBoxColumn/DataGridViewNumericUpDownColumn/DataGridViewDateTimeColumn (the control type for the column)<br>
        <b>assembly</b> (of the control type, specify this if you are using a custom 
        type)<br>
        <b>editable</b> =<i>true</i>/false (whether the property  can be edited 
        directly on the grid, irrelevant if grid is read-only)<br>
        <b>width</b> =<i>100</i> (in pixels)<br>
        <b>alignment</b> =<i>left</i>/right/center/centre</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b><a name="form" class="specclasslink">form</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Defines how the class properties are displayed in 
        a user interface editing form.&nbsp; Here you can list a set of tab, 
        column or field elements, but not a combination of the three at the same 
        level.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">ui</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">tab (1..*)<br>
        columnLayout (1..*)<br>
        field (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>title</b> (the window heading as it appears to 
        the user)<br>
        <b>width</b> =<i>200</i> (in pixels)<br>
        <b>height</b> =<i>200</i> (in pixels)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b>
    <a name="tab" class="specclasslink">tab</a></b></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Creates a tab in the editing form window. Several 
        tabs can be created, but if there is only one tab, then you don't need 
        to include this element.&nbsp; Under this element you can have either 
        columnLayout or field elements but not a combination of the two.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">form</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">columnLayout (1..*)<br>
        field (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>name</b> (the name of the tab as it appears to the 
        user)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom">-</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass"><b>
    <a name="columnLayout" class="specclasslink">columnLayout</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Holds a column of controls in an editing form.&nbsp; 
        If you will only have one column, then you don't need to include this 
        element.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">tab, form</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">field (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>width</b> (in pixels)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b><a name="field" class="specclasslink">field</a></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Defines a control to edit a field/property in an editing form.&nbsp; 
        &quot;parameter&quot; elements can be used to add further specifications for the 
        control.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">columnLayout, tab, form</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">parameter (1..*)</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>label</b> (the label to appear next to the control on 
        the form)<br>
        <b>property</b> (the property to edit)</td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom"><b>editable</b> =<i>true</i>/false<i><br>
        </i><b>type</b> =<i>TextBox</i> (the class name of the type of 
        control)<br>
        <b>assembly</b> =<i>System.Windows.Forms</i> (the assembly of the 
        control type)<br>
        <b>mapperType</b> =<i>TextBoxMapper</i> (the class used to map the control 
        to the business object property, Habanero provides mappers for the 
        standard controls, you can leave this off for TextBox, ComboBox, 
        CheckBox, DateTimePicker, ListView and NumericUpDown)<br>
        <b>mapperAssembly</b> (specify this if you are using a custom mapper)</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  <tr>
  	<td class="specclass">
    <b>
    <a name="parameter" class="specclasslink">parameter</a></b></b></td>
    <td width="83%" valign="top">
    <font size="2">
    <table border="0" cellpadding="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" class="spec">
      <tr>
        <td width=170 class="specname">Description:</td>
        <td class="specvalue">Adds additional definitions for a control being 
        displayed in an editing form, such as a list of items to display in a 
        ComboBox.&nbsp; There is no error-checking on unsupported types, so 
        ensure correct usage.</td>
      </tr>
      <tr>
        <td class="specname">Comes under:</td>
        <td class="specvalue">field</td>
      </tr>
      <tr>
        <td class="specname">Must contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Can contain:</td>
        <td class="specvalue">-</td>
      </tr>
      <tr>
        <td class="specname">Compulsory attribs:</td>
        <td class="specvalue"><b>name</b> (the name of the type of setting - see below 
        for examples)<br>
        <b>value</b> (the values to apply to the above setting - see below)<br>
        <br>
        The following options are available:<br>
        <font size="2">
        <table border="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#C0C0C0" width="100%" id="AutoNumber7" class="options">
          <tr>
            <td width="100" class="options">options</td>
            <td class="options">pipe-separated list of choices in a ComboBox 
            (specify the mapperType as &quot;ListComboBoxMapper&quot;)<br>
            - eg. value=&quot;M|F&quot;</td>
          </tr>
          <tr>
            <td class="options">numLines</td>
            <td class="options">number of lines in a TextBox</td>
          </tr>
          <tr>
            <td class="options">isEmail</td>
            <td class="options">if so, user can double-click on a valid email and open in default 
            mail client, value=&quot;true&quot;</td>
          </tr>
          <tr>
            <td class="options">colSpan</td>
            <td class="options">the number of columns for the field control to 
            span across</td>
          </tr>
          <tr>
            <td class="options">rowSpan</td>
            <td class="options">the number of rows for the field control to span 
            across</td>
          </tr>
          <tr>
            <td class="options">decimalPlaces</td>
            <td class="options">the number of decimals to allow when 
            NumericUpDownMoneyMapper is used</td>
          </tr>
        </table>
        </font>
        </td>
      </tr>
      <tr>
        <td class="specnamebottom">Optional attribs:</td>
        <td class="specvaluebottom">-</td>
      </tr>
    </table>
    </font>
    </td>
  </tr>

  </table>
<p>To review:</p>
<ul>
  <li>relprop (can propnames be different?)</li>
  <li>add rule (extensibility class/ass name)</li>
  <li>dbLL (class/ass use, 
  timeout implemented?)</li>
  <li>boLL (must use Guids?, dbl-check criteria implemented)</li>
  <li>primKey (objectID)</li>
  <li>rel (property to primKey?)</li>
  <li>property (mark - longtext, bytestring?)</li>
  <li>rule (class/ass?)</li>
  <li>field (assembly implemented?)</li>
  <li>key (message implemented?)</li>
  <li>column (assembly implemented?)</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>

<p>&nbsp;</p>

<font face="Verdana,Arial,Helvetica" size="2">

<hr>
<table border="1" cellpadding="7" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber5" bgcolor="#E4E4E4">
  <tr>

<font face="Verdana,Arial,Helvetica">

    <td width="100%">

<font face="Verdana,Arial,Helvetica">

<b><font face="Verdana" size="4"><a name="AppendixII">Appendix II - Using 
Log4net</a></font></b></font></td>
    </font>
  </tr>
</table>
<p><font face="Verdana" size="2">Log4net is a system used by Habanero for logging output from 
your application.&nbsp; Log files give you assistance in several ways, including 
analysing system faults remotely, tracking system usage, tracing the process 
that led to a breakdown and understanding where the system failed when you don't 
have any other visual response.</font></p>
<p><font face="Verdana" size="2">Habanero logs output to this logging system, 
and you can use logging calls in your code to add to this output.&nbsp; Log4net is highly flexible, allowing you to specify the log 
output medium (eg. text file), the output format and the output detail level 
(eg. errors only, or all debug information).</font></p>
<p><font size="3"><b>Setting Up Logging Support</b></font></p>

<p><font face="Verdana" size="2">The settings are laid out in the app.config 
file (or your equivalent config file) between the configuration tags.&nbsp; 
First declare the &quot;log4net&quot; settings type in &quot;configSections&quot; as follows:</font></p>

<table class="code" border="1" cellspacing="0">
  <tr>

    <td width="100%" class="codeitself">
    <pre><code>&lt;configSections&gt;
  &lt;section name=&quot;log4net&quot; type=&quot;log4net.Config.Log4NetConfigurationSectionHandler, log4net&quot;/&gt;
&lt;/configSections&gt;</code></pre>
    </td>
  </tr>
</table>
<p><font face="Verdana" size="2">Then specify the &quot;log4net&quot; settings - here is 
an example which you could use:</font></p>

<table class="code" border="1" cellspacing="0">
  <tr>

<font face="Verdana,Arial,Helvetica" size="2">

    <td width="100%" class="codeitself">
    <pre><code>&lt;log4net&gt;
  &lt;appender name=&quot;FileAppender&quot; type=&quot;log4net.Appender.FileAppender&quot;&gt;
    &lt;param name=&quot;File&quot; value=&quot;log.txt&quot;/&gt;
    &lt;param name=&quot;AppendToFile&quot; value=&quot;true&quot;/&gt;
    &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;
      &lt;param name=&quot;ConversionPattern&quot; value=&quot;%d [%t] %-5p %c [%x] - %m%n&quot;/&gt;
    &lt;/layout&gt;
  &lt;/appender&gt;
  &lt;root&gt;
    &lt;level value=&quot;INFO&quot;/&gt;
    &lt;appender-ref ref=&quot;FileAppender&quot;/&gt;
  &lt;/root&gt;
&lt;/log4net&gt;</code></pre>
    </td>
    </font>
  </tr>
</table>
<p><font face="Verdana" size="2">The settings above specify the log output file 
name, that the existing file will append new data, the output format and that all output 
of type &quot;INFO&quot; or more serious will be logged.&nbsp; &quot;DEBUG&quot; is the 
lowest level and will display all types of logging output.</font></p>
<p><font size="3"><b>Using Logging in Your Own Code</b></font></p>
<p><font face="Verdana" size="2">To use logging in your own code, you'll need to 
setup a logger in each class where you want to send logging output.&nbsp; 
Include &quot;log4net&quot; as follows:</font></p>

<table class="code" border="1" cellspacing="0">
  <tr>

    <td width="100%" class="codeitself">
    <pre><code>using log4net;</code></pre>
    </td>
  </tr>
</table>
<p>Then add the logging object to your class fields like this:</p>

<table class="code" border="1" cellspacing="0">
  <tr>

    <td width="100%" class="codeitself">
    <pre><code>private static readonly ILog log = LogManager.GetLogger(&quot;yourClassName&quot;);</code></pre>
    </td>
  </tr>
</table>
<p>Finally you can send log output anywhere in the code of that class like this:</p>

<table class="code" border="1" cellspacing="0">
  <tr>

    <td width="100%" class="codeitself">
    <pre><code>log.Info(&quot;The application is starting...&quot;);
log.Debug(&quot;System variable set to: xyz&quot;);
log.Error(&quot;An error has occurred in the startup section.&quot;);</code></pre>
    </td>
  </tr>
</table>
<p><font face="Verdana" size="2">For more information on log4net, visit the 
homepage at: <a href="http://logging.apache.org/log4net">http://logging.apache.org/log4net</a></font><br>
You can also get configuration options at: <a href="http://logging.apache.org/log4net/release/manual/configuration.html">http://logging.apache.org/log4net/release/manual/configuration.html</a></p>
</font>
<p><b><font size="3">User-Friendly Error Form</font></b></p>

<p><font size="2">The HabaneroApp class has an ExceptionNotifier property, which 
allows you to specify a standard form to display error messages (do this before 
calling Startup).&nbsp; This form must implement IExceptionNotifier.&nbsp; By 
default, Habanero supplies its own error display form, which hides the messy 
details from a final user, but still allows a developer to view the stack trace.&nbsp; 
While the form will automatically popup during the program launch, during normal 
run-time, you will need to enclose the code in a try-catch block.&nbsp; Here is 
a sample implementation in Program.cs, the root class.</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself"><pre><code>using Habanero.Base;</code></pre></td>
  </tr>
</table>
<p><font size="2">And in the Main() method:</font></p>
<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself"><pre><code>try
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.Run(new Form1());
}
catch (Exception ex)
{
    GlobalRegistry.UIExceptionNotifier.Notify(ex,
    &quot;An error has occurred in the application.&quot;,
    &quot;Application Error&quot;);
}</code></pre></td>
  </tr>
</table>
<p>You can also mask the exception so that naive users aren't hit with the full 
details of a complicated error message:</p>

<table class="code" border="1" cellspacing="0">
  <tr>
    <td width="100%" class="codeitself"><pre><code>GlobalRegistry.UIExceptionNotifier.Notify(
    new UserException(&quot;An error has occurred in the application.&quot;, ex),
    &quot;An error has occurred in the application.&quot;,
    &quot;Application Error&quot;);</code></pre></td>
  </tr>
</table>

<p>&nbsp;</p>

<p>&nbsp;</p>
<hr>
<table border="1" cellpadding="7" cellspacing="0" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%" id="AutoNumber9" bgcolor="#E4E4E4">
  <tr>

<font face="Verdana,Arial,Helvetica" size="4">

    <td width="100%">

<b><a name="Troubleshooting">Troubleshooting</a></b></td>
    </font>
  </tr>
</table>

<font size="2">

<p><b><font size="3">Troubleshooting FAQ</font></b></p>
<ul>

<font size="2" face="Verdana,Arial,Helvetica">

  <li><b>Application is not working</b><ul>
    <li>Is the code correct?</li>
    <li>Do you have an app.config file that is correctly configured?</li>
    <li>Do you have a classdefs.xml file and is it accessible in the output 
    folder with the executables?</li>
    <li>Does the class definition have the required basic elements?</li>
    <li>Is there a class element for each class,

<font face="Verdana" size="2">

    a class for each class element and a database table for each class element?</font></li>
    <li>Do all the table names and field names match up case-sensitively with 
    both the database field names and the properties in the class? (If in doubt, 
    add a table attribute to your class element)</li>
    <li>Are their any property names misspelt in the rest of the class 
    definitions?</li>
    <li>Are all the data types correct in your classes, the class definitions and the 
    database?</li>
  </ul>
  </li>

<font size="2" face="Verdana,Arial,Helvetica">

  <li><b>&quot;Object reference not set to an instance of an object.&quot;</b><ul>

<li>This is a .Net error thrown when a null reference is being encountered.&nbsp; 
This is a common exception that is not related to any particular area of code, 
so you'll need to do some further research to try and isolate the code that is 
throwing the exception.</li>

</ul>
  </li>
</font>

</font>

  <li><b>Class definitions</b><ul>
  <li>Classdefs.xml not found<ul>
  <li>While the class definitions may be stored under your project or assembly, 
  they need to be copied to your execution directory as well (eg. bin, debug, 
  output).&nbsp; Either add a build command to copy the file at run-time or use 
  a feature like Visual Studio's where you can set the properties on 
  &quot;classdefs.xml&quot; so that it is copied to the output directory.</li>
</ul>
  </li>
  <li>Can't find control, mapper or assembly for a field/grid control<ul>
  <li>Apart from checking for the obvious (does the type or mapper exist in the 
  assembly as specified?), check that the assembly you're referring to has been 
  referenced in the relevant project (try referencing it in the other projects 
  if you've got multiple ones).</li>
</ul>
  </li>
</ul>
  </li></font>

<font size="2">

  <li><b>Database issues</b><ul>
  <li>Changes not being saved to database<ul>
  <li>If you edit an object in a default form, the changes should be committed 
  automatically, but if you edit values at code level, you need to call Save() on the object to commit the changes.</li>
</ul>
  </li>
</ul>
  </li>
  <li><b>User Interface issues</b><ul>
  <li>ComboBox displaying wrong information<ul>
  <li>There are two means to display data in a ComboBox using the class 
  definitions.&nbsp; You can specify a set list of options using 
  &quot;attribute&quot; elements (see Appendix I), or you can set the list to be dynamically 
  loaded when the form comes up, using the lookup-list source options.&nbsp; 
  These need a pair of strings and Guids, with the strings displayed to the user 
  and the Guids stored in the property values.&nbsp; Your property type therefor 
  needs to be a Guid.</li>
</ul>
  </li>

<font face="Verdana" size="2">

  <li>No objects appear in the grid<ul>
  <li>When you create a business object collection to pass to the grid, you need 
  to load the objects in the collection using the collection's Load() command 
  (of which the simplest form is Load(&quot;&quot;,&quot;&quot;)).</li>
</ul>
  </li>
  <li>Can't edit a date<ul>
  <li>You are unable to edit a DateTime property in a textbox.&nbsp; Rather use 
  a DateTimePicker (along with the DateTimePickerMapper), which are easier to 
  use and have better error checking.</li>
</ul>
  </li>
  </font>
</ul>
  </li>
  </font>

<font size="2">

  <li><b>Why do I get an empty form?</b><ul>
  <li>If you've created an form-based application and nothing is showing in your 
  form, then you need to decide what to show in the form, such as a grid 
  containing your data or a menu that opens other grids or forms.&nbsp; See the 
  tutorial on examples for displaying data in a form using Habanero.</li>
  <li>If you've set a grid to display and have no data showing in the grid, even 
  though there is a data in the database, ensure that you called the Load() 
  command on the business object collection, or that you didn't use criteria 
  that the data couldn't adhere to.</li>
</ul>
  </li>

<li><b>Naming issues</b><ul>

<li>Dashes in the assembly name<ul>

<li>In Visual Studio, putting a dash in the assembly name will result in an 
underscore in the namespace.&nbsp; This will cause failures with Habanero - 
while we create a workaround for this problem, we suggest you avoid using dashes 
in the assembly names.</li>

</ul>
</li>

</ul>
</li>

</ul>
</font>

<p>(this list is a work in progress)</p>
<hr>
<p><font face="Verdana" size="2">Issues to deal with:</font></p>
<ul>
  <li><font face="Verdana" size="2">Concurrency/synch</font></li>
  <li><font face="Verdana" size="2">Alternate DB vendors</font></li>
  <li><font face="Verdana" size="2">the concept of persisted values cf normal 
  values (may need to edit code comments more)</font></li>
  <li><font face="Verdana" size="2">Loaded objects in BusinessObject 
  (pre-loaded?), timeout periods</font></li>
  <li><font face="Verdana" size="2">cover progress indicators/user feedback</font></li>
  <li><font face="Verdana" size="2">list of required DLLs (for each database 
  vendor)</font></li>
  <li><font face="Verdana" size="2">at the end of each step, list the classes 
  covered so far, or at least additional classes now covered</font></li>
  <li><font face="Verdana" size="2">use of expressions</font></li>
  <li><font face="Verdana" size="2">use of parameterised sql</font></li>
  <li><font face="Verdana" size="2">a quick reference card</font></li>
  <li><font face="Verdana" size="2">where to reference habanero - always copy 
  dll's or environment variables on where to find them (and others like classdef 
  dtd, log4net, ms app exc)</font></li>
  <li><font face="Verdana" size="2">links to websites with basic sql tutorial 
  (w3c) and database vendor introduction</font></li>

<font face="Verdana" size="2">

  <li>list of assemblies and important classes, comments etc (does this 
  duplicate the documentation?)</li>

  <li>non C# users?</li>

  <li>add file name header to each code section</li>

  <li>FEATURES: csvfile reader/writer + how to set column headers</li>

  <li>give examples of configuring habaneroapp before startup()</li>
  <li>what is our policy on integer primary keys (and auto-increments)?</li>
  <li>database number generators</li>
  <li>combine all ComputerPart fields into db right at the start, not two 
  chapters</li>
  <li>how many directions for rel between partsorder and orderitems (and should 
  foreign key then be both ways too?)</font><font face="Verdana,Arial,Helvetica" size="2"><font face="Verdana" size="2"><br>
&nbsp;</font></li>
</ul>

</body>
</html>